!function e(t,n,r){function o(s,u){if(!n[s]){if(!t[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return o(n?n:e)},l,l.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../lib/Logger"),i=e("../../sandbox/modules/BaseModule"),s="api",u=function(e){function t(t,n){var r=e.call(this)||this;return r.window=t,r.validators=n,r}return r(t,e),t.prototype.start=function(){var e=this;o.logger.debug(null,"Setting up API");var t={push:function(t){return e.newMessageReceived(t)}};if(this.window._yieldify)if(this.window._yieldify&&this.window._yieldify.messages instanceof Array){var n=this.window._yieldify.messages;this.window._yieldify.messages=t,n instanceof Array&&n.forEach(function(t){return e.newMessageReceived(t)})}else o.logger.error(null,"Error setting up API. Unexpected global state prior to API message bus setup");else this.window._yieldify={messages:t}},t.prototype["interface"]=function(){var e=this;return{sendToSandbox:function(t){return e.sendToSandbox(t)}}},t.prototype.getRoutingLabel=function(){return s},t.prototype.newMessageReceived=function(e){o.logger.debug({message:e},"Received API Message"),this.validateMessage(e)?(o.logger.debug(null,"Message valid, passing to sandbox"),this.sendToSandbox(e)):o.logger.error(null,"API Message didn't pass any validators")},t.prototype.validateMessage=function(e){for(var t=0,n=this.validators;t<n.length;t++){var r=n[t];if(r(e))return!0}return!1},t.prototype.sendToSandbox=function(e){return this.invokeMethod("sendToSandbox",e)},t}(i.BaseModule);n.APIHost=u},{"../../lib/Logger":15,"../../sandbox/modules/BaseModule":30}],2:[function(e,t,n){"use strict";function r(e){return"object"==typeof e&&"PING"===e.type&&"string"==typeof e.message}function o(e,t){c.logger.debug({pingMessage:e.message},"API PING!")}function i(e){return"object"==typeof e&&"EXTERNAL_VALUE_UPDATED"===e.type&&"string"==typeof e.name&&"string"==typeof e.pageType&&("string"==typeof e.value||"number"==typeof e.value)}function s(e,t){var n=u.externalValue(e.name,e.pageType)(t.getState());return void 0===n?void c.logger.error({externalValueUpdate:e},"Invalid external value update"):"String"===n.dataType&&"string"!=typeof e.value||"Integer"===n.dataType&&"number"!=typeof e.value||"Float"===n.dataType&&"number"!=typeof e.value?void c.logger.error({externalValueUpdate:e},"Invalid external value update"):void t.dispatch(a.pageElementValueUpdated(n.id,e.value))}Object.defineProperty(n,"__esModule",{value:!0});var u=e("../redux/reducers/page-elements"),a=e("../redux/actions/page-elements"),c=e("../../lib/Logger");n.messageValidators=[r,i],n.validatePingMessage=r,n.handlePingMessage=o,n.validateExternalValueUpdatedMessage=i,n.handleExternalValueUpdate=s},{"../../lib/Logger":15,"../redux/actions/page-elements":7,"../redux/reducers/page-elements":8}],3:[function(e,t,n){"use strict";function r(){i.logger.debug(null,"Starting sandbox setup."),i.logger.debug({builder:S,tag:C},"Versions:");var e=new b.EventConverter(b.SERIALISATION_DESCS),t=new y.DOMUtil(document),n=new g.WindowUtil(window),r=new s.CrossOriginServer(window),m=new f.JSONSandbox(document),P=new u.IFrameCreator(r,m,document,t),I=new l.DOMHost(t,e),R=new p.WindowHost(n,e),A=new d.CookieHost,j=new v.APIHost(window,_.messageValidators),T=new h.LocalStorageHost(localStorage),k=new c.IFrameHost(P),N=new O.AnalyticsHost,D={websiteConfig:E,cookies:document.cookie,localStorage:localStorage.getItem(w),location:n.getLocation(),referrer:document.referrer,tagVersion:C,windowDimensions:n.getInnerDimensions()},x={initConfig:m.stringify(D),provide:[I,R,A,T,k,j,N]},B={src:o.addHashParameters(M,o.getHash(window)),parentElement:"body",name:L};P.create(B).then(a.RemoteWindow.connect(m,x)).then(function(e){i.logger.debug({sandbox:e},"Sandbox Initialised"),j.start()})}Object.defineProperty(n,"__esModule",{value:!0});var o=e("../lib/utils"),i=e("../lib/Logger"),s=e("../sandbox/remote-windows/CrossOriginServer"),u=e("../sandbox/remote-windows/IFrameCreator"),a=e("../sandbox/remote-windows/RemoteWindow"),c=e("../sandbox/modules/iframe/Host"),l=e("../sandbox/modules/dom/Host"),f=e("../lib/JSONSandbox"),p=e("../sandbox/modules/window/Host"),d=e("../sandbox/modules/cookie/Host"),v=e("./api/Host"),h=e("../sandbox/modules/local-storage/Host"),y=e("../lib/browser/DOMUtil"),g=e("../lib/browser/WindowUtil"),b=e("../lib/events/EventConverter"),m=e("../lib/events/EventTargetUtil"),_=e("./api/messages"),O=e("./integrations/analytics/Host"),E="{\"campaigns\":[],\"organisationId\":191,\"trackerEndpoint\":\"v2.dc.yieldify.com\",\"gatewayEndpoint\":\"https://gateway.yieldify.com\",\"websiteId\":192,\"cookieDomain\":null,\"websiteCurrency\":\"USD\",\"gaIntegration\":false,\"scraping\":{\"pageTypes\":[{\"name\":\"common\",\"urlPattern\":\".*\",\"pageElements\":[{\"id\":766,\"name\":\"mini-basket-value\",\"type\":\"PageElementValue\",\"selector\":null,\"dataType\":\"Float\",\"attr\":null,\"regex\":null}]},{\"name\":\"basket\",\"urlPattern\":null,\"pageElements\":[{\"id\":765,\"name\":\"total\",\"type\":\"PageElementValue\",\"selector\":null,\"dataType\":\"Float\",\"attr\":null,\"regex\":null}]},{\"name\":\"last-price\",\"urlPattern\":null,\"pageElements\":[{\"id\":767,\"name\":\"total\",\"type\":\"PageElementValue\",\"selector\":null,\"dataType\":\"Float\",\"attr\":null,\"regex\":null}]},{\"name\":\"thankyou\",\"urlPattern\":null,\"pageElements\":[{\"id\":768,\"name\":\"order-id\",\"type\":\"PageElementValue\",\"selector\":null,\"dataType\":\"String\",\"attr\":null,\"regex\":null}]}],\"domainEntities\":[{\"name\":\"basket\",\"properties\":[{\"name\":\"value\",\"dataType\":\"Float\",\"valueSourceIds\":[765,766]}]},{\"name\":\"sale\",\"properties\":[{\"name\":\"sale-total-value\",\"dataType\":\"Float\",\"valueSourceIds\":[767]},{\"name\":\"order-id\",\"dataType\":\"String\",\"valueSourceIds\":[768]}]}]},\"mapping\":{\"thankYou\":{\"url\":null}}}",w="_yi",M="https://td.yieldify.com/0.0.1/tag/1.51.0/main.html",S="1.51.0",C="1.51.0",L="yie-sandbox";o.initialiseDebugMode(window),o.isDebugMode()&&(i.logger.setLevel(i.Level.DEBUG),i.logger.enableConsoleLogging());try{document.body?(i.logger.debug(null,"document.body already present, setting up synchronously."),r()):(i.logger.debug(null,"document.body not ready, setting up asynchronously."),m.EventTargetUtil.addEventListener(document,"DOMContentLoaded",function(){i.logger.debug(null,"document.body found, setting up."),r()}))}catch(P){i.logger.error({error:P},"Error in code.js")}},{"../lib/JSONSandbox":14,"../lib/Logger":15,"../lib/browser/DOMUtil":20,"../lib/browser/WindowUtil":21,"../lib/events/EventConverter":22,"../lib/events/EventTargetUtil":23,"../lib/utils":29,"../sandbox/modules/cookie/Host":33,"../sandbox/modules/dom/Host":35,"../sandbox/modules/iframe/Host":37,"../sandbox/modules/local-storage/Host":39,"../sandbox/modules/window/Host":41,"../sandbox/remote-windows/CrossOriginServer":42,"../sandbox/remote-windows/IFrameCreator":44,"../sandbox/remote-windows/RemoteWindow":45,"./api/Host":1,"./api/messages":2,"./integrations/analytics/Host":5}],4:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../../sandbox/modules/BaseModule"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getRoutingLabel=function(){return"analytics"},t.prototype["interface"]=function(){return{forwardEvent:this.forwardEvent}},t}(o.BaseModule);n.AnalyticsBase=i},{"../../../sandbox/modules/BaseModule":30}],5:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("./Base"),i=e("../../../lib/Logger"),s=e("../../../lib/Promise"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.forwardEvent=function(e){return i.logger.debug({event:e},"Forwarding event to the analytics object"),s["default"].resolve(null)},t}(o.AnalyticsBase);n.AnalyticsHost=u},{"../../../lib/Logger":15,"../../../lib/Promise":18,"./Base":4}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../../../lib/CachingObservable");n.SCRAPING_INTERVAL_MS=500;var o=function(){function e(e,t,n,r){if(this.domUtil=e,this.asyncWorker=t,this.selector=n,this.attr=r,!this.domUtil.validateSelector(this.selector))throw new Error("Invalid selector: "+this.selector)}return e.prototype.start=function(){var e=this;this.valuesObservable=new r.CachingObservable,this.setTimeoutId=this.asyncWorker.performAsyncCallback(function(){e.valuesObservable.publishIfChanged(e.domUtil.scrape(e.selector,e.attr))},n.SCRAPING_INTERVAL_MS,n.SCRAPING_INTERVAL_MS)},e.prototype.stop=function(){this.asyncWorker.stopCallback(this.setTimeoutId)},e.prototype.getValuesObservable=function(){return this.valuesObservable},e}();n.ValueScraper=o},{"../../../../lib/CachingObservable":11}],7:[function(e,t,n){"use strict";function r(e,t){return{type:"PAGE_ELEMENT_VALUE_UPDATED",id:e,value:t}}function o(e){return{type:"PAGE_ELEMENT_VALUES_SYNC",elements:e}}Object.defineProperty(n,"__esModule",{value:!0}),n.pageElementValueUpdated=r,n.pageElementValuesSync=o},{}],8:[function(e,t,n){"use strict";function r(e){var t=e.scraping.pageTypes.map(function(e){return e.pageElements.map(function(t){return{key:t.id.toString(),value:{id:t.id,name:t.name,pageTypeName:e.name,type:t.type,dataType:t.dataType,values:[]}}})});return s.dict(u.flatten(t))}function o(e,t){switch(void 0===e&&(e={}),t.type){case"PAGE_ELEMENT_VALUES_SYNC":return t.elements;case"PAGE_ELEMENT_VALUE_UPDATED":return a.update(e).get(t.id.toString()).set(function(e){return e?{id:t.id,name:e.name,pageTypeName:e.pageTypeName,type:e.type,dataType:e.dataType,values:i(e.values,t.value)}:e});default:return e}}function i(e,t){return 0===e.length?[t]:e[0]===t?e:null===t?[null].concat(e):[t]}Object.defineProperty(n,"__esModule",{value:!0});var s=e("../../../lib/Dictionary"),u=e("../../../lib/list"),a=e("../../../lib/updater"),c=e("../../../lib/selectors");n.initialPageElementsState=r,n.pageElementsReducer=o,n.updateValueHistory=i,n.pageElements=function(e){return e.pageElements},n.pageElementValue=function(e){return c.selector(n.pageElements,function(t){var n=t[e.toString()];if(void 0!==n)return n.values})},n.externalValue=function(e,t){return c.selector(n.pageElements,function(n){return u.find(s.values(n),function(n){return t===n.pageTypeName&&e===n.name&&"ExternalValue"===n.type})})}},{"../../../lib/Dictionary":13,"../../../lib/list":26,"../../../lib/selectors":27,"../../../lib/updater":28}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Logger"),o=function(){function e(){this.nextCallbackId=0,this.timeoutKey=0,this.timeoutIdMap={}}return e.prototype.performAsyncCallback=function(e,t,n){var r=this,o=++this.timeoutKey;return this.timeoutIdMap[o]=setTimeout(function(){r.executeCallback(o,e,n,n)},t),o},e.prototype.stopCallback=function(e){try{clearTimeout(this.timeoutIdMap[e])}catch(t){r.logger.error({error:t,timeoutKey:e},"Could not stop the callback.")}},e.prototype.cancelPendingCallbacks=function(){this.cancelBeforeId=this.nextCallbackId},e.prototype.executeCallback=function(e,t,n,o){var i=this,s=this.nextCallbackId++;if(!(this.cancelBeforeId&&s<this.cancelBeforeId))try{t()}catch(u){r.logger.error({error:u},"Async callback failed.")}finally{o&&(this.timeoutIdMap[e]=setTimeout(function(){i.executeCallback(e,t,o,o)},n))}},e}();n.AsyncWorker=o},{"./Logger":15}],10:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("./Observable"),i=100,s=function(e){function t(t){void 0===t&&(t=i);var n=e.call(this)||this;return n.buffer=[],n.maxBufferSize=t,n}return r(t,e),t.prototype.publish=function(t){if(0===this.subscribers.length){if(this.buffer.length>=this.maxBufferSize)throw new Error("Max buffered values limit reached");this.buffer.push(t)}else e.prototype.publish.call(this,t)},t.prototype.subscribe=function(t){var n=e.prototype.subscribe.call(this,t);return this.buffer.length>0&&this.flush(),n},t.prototype.flush=function(){var t=this.buffer;this.buffer=[];for(var n=0,r=t;n<r.length;n++){var o=r[n];e.prototype.publish.call(this,o)}},t}(o.Observable);n.BufferingObservable=s},{"./Observable":16}],11:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("../lib/Observable"),i=e("../lib/DeepEqual"),s=e("../lib/Promise"),u=function(e){function t(){return e.call(this)||this}return r(t,e),t.cache=function(e){var n=new t;return e.subscribe(function(e){n.publishIfChanged(e)}),n},t.prototype.publish=function(t){this.value=t,e.prototype.publish.call(this,t)},t.prototype.publishIfChanged=function(e){return!i.DeepEqual.deepEqual(e,this.getCurrentValue())&&(this.publish(e),!0)},t.prototype.getCurrentValue=function(){return this.value},t.prototype.getValue=function(){var e=this;return new s["default"](function(t,n){if("undefined"!=typeof e.value)t(e.value);else var r=e.subscribe(function(e){t(e),r.dispose()})})},t.prototype.toJSON=function(){return{value:this.value}},t}(o.Observable);n.CachingObservable=u},{"../lib/DeepEqual":12,"../lib/Observable":16,"../lib/Promise":18}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.deepEqual=function(t,n){if(null===t||null===n)return t===n;if("undefined"==typeof t||"undefined"==typeof n)return t===n;if(e.isPrimitive(t)||e.isPrimitive(n))return t===n;if(t instanceof Date)return n instanceof Date&&t.getTime()===n.getTime();var r=Object.getOwnPropertyNames(t),o=Object.getOwnPropertyNames(n);if(r.length!==o.length)return!1;r.sort(),o.sort();for(var i=0;i<r.length;i++)if(r[i]!==o[i])return!1;for(var s=0,u=r;s<u.length;s++){var a=u[s];if(!e.deepEqual(t[a],n[a]))return!1}return!0},e.isPrimitive=function(e){return/boolean|number|string/.test(typeof e)},e}();n.DeepEqual=r},{}],13:[function(e,t,n){"use strict";function r(e){return Object.keys(e).map(function(t){return e[t]})}function o(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t}function i(e,t){void 0===t&&(t=n.lastValueWins);for(var r={},o=0,i=e;o<i.length;o++){var s=i[o];void 0!==r[s.key]&&(s=t({key:s.key,value:r[s.key]},s)),r[s.key]=s.value}return r}function s(e,t){return i(o(e).map(t))}function u(e,t){return s(e,function(e){var n=e.key,r=e.value;return{key:n,value:t(r,n)}})}Object.defineProperty(n,"__esModule",{value:!0}),n.values=r,n.entries=o,n.lastValueWins=function(e,t){return t},n.dict=i,n.dictMap=s,n._dictMap=function(e){return function(t){return s(t,e)}},n.dictMapValues=u,n._dictMapValues=function(e){return function(t){return u(t,e)}}},{}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e){this.json=this.setupJSON(e)}return e.prototype.setupJSON=function(e){var t=e.createElement("iframe");return t.style.display="none",t.name="yie-js",e.body.appendChild(t),t.contentWindow.JSON},e.prototype.parse=function(e,t){return this.json.parse(e,t)},e.prototype.stringify=function(e){return this.json.stringify(e)},e}();n.JSONSandbox=r},{}],15:[function(e,t,n){"use strict";function r(e){return u.indexOf(e)}var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./BufferingObservable"),s=e("./Dictionary");n.Level={DEBUG:"DEBUG",INFO:"INFO",WARN:"WARN",ERROR:"ERROR",FATAL:"FATAL"};var u=["DEBUG","INFO","WARN","ERROR","FATAL"];n.MAX_REMOTE_LOG=20,n.MAX_LOG_PAYLOAD=1500;var a=function(e){function t(){var t=e.call(this)||this;return t.level=n.Level.INFO,t.consoleLogging=!1,t.messageCount=0,t.messageBuffer=[],t.isRecursing=!1,t}return o(t,e),t.prototype.debug=function(e,t){this.log(n.Level.DEBUG,t,e)},t.prototype.info=function(e,t){this.log(n.Level.INFO,t,e)},t.prototype.warn=function(e,t){this.log(n.Level.WARN,t,e)},t.prototype.error=function(e,t){this.log(n.Level.ERROR,t,e)},t.prototype.fatal=function(e,t){this.log(n.Level.FATAL,t,e)},t.prototype.getLevel=function(){return this.level},t.prototype.setLevel=function(e){this.level=e},t.prototype.enableConsoleLogging=function(){this.consoleLogging=!0},t.prototype.publish=function(t){this.messageCount>=n.MAX_REMOTE_LOG||(e.prototype.publish.call(this,t),this.messageCount++,this.messageCount>=n.MAX_REMOTE_LOG&&(this.consoleLog(n.Level.DEBUG,"Remote log cap reached"),e.prototype.publish.call(this,{level:n.Level.WARN,message:JSON.stringify({msg:"Log message cap reached, log truncated"}),timestamp:(new Date).getTime()})))},t.prototype.log=function(e,t,o){if(!(r(e)<r(this.level))){var i=this.normaliseArgs(o);if(this.consoleLog(e,t,i),this.isRecursing)return void this.consoleLog(n.Level.WARN,"Log message triggered while logging. skipping remote log");this.isRecursing=!0,this.remoteLog(e,t,i),this.isRecursing=!1}},t.prototype.remoteLog=function(e,t,r){t=t||"";var o;try{o=JSON.stringify({msg:t,args:r})}catch(i){return void this.consoleLog(n.Level.WARN,"Couldnt serialise remote log message")}o.length>n.MAX_LOG_PAYLOAD&&(o=JSON.stringify({msg:t.substring(0,n.MAX_LOG_PAYLOAD)}),this.consoleLog(n.Level.WARN,"Log message was truncated before sending remotely")),this.publish({level:e,message:o,timestamp:(new Date).getTime()})},t.prototype.consoleLog=function(e,t,r){if(this.consoleLogging)switch(t+=t.match("\n$")?"":"\n",e){default:case n.Level.DEBUG:console.log(t,r);break;case n.Level.INFO:console.info(t,r);break;case n.Level.WARN:console.warn(t,r);break;case n.Level.ERROR:case n.Level.FATAL:console.error(t,r)}},t.prototype.normaliseArgs=function(e){var t=this;if(e)return s.dictMapValues(e,function(e,n){var r;return r=e instanceof Error?t.serialiseError(e):"undefined"!=typeof ErrorEvent&&e instanceof ErrorEvent?e.error?t.serialiseError(e.error):t.serialiseErrorEvent(e):e})},t.prototype.serialiseError=function(e){return{name:e.name,message:e.message,fileName:e.fileName,lineNumber:e.lineNumber,columnNumber:e.columnNumber,stack:e.stack?e.stack.split("\n")[1]:void 0}},t.prototype.serialiseErrorEvent=function(e){return{message:e.message,fileName:e.filename,lineNumber:e.lineno,columnNumber:e.colno}},t}(i.BufferingObservable);n.Logger=a,n.logger=new a},{"./BufferingObservable":10,"./Dictionary":13}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Promise"),o=e("./DeepEqual"),i=function(){function e(){this.subscribers=[],this.publishCount=0}return e.merge=function(t){var n=new e;return t.forEach(function(e){e.subscribe(function(e){n.publish(e)})}),n},e.map=function(t,n){var r=new e;return t.subscribe(function(e){return r.publish(n(e))}),r},e.pluck=function(t,n){return e.map(t,function(e){return e[n]})},e.fromSelector=function(t,n){var r,o=new e;return n.subscribe(function(){var e=t(n.getState());e!==r&&(o.publish(e),r=e)}),o},e.prototype.subscribe=function(e){if(this.subscribers.indexOf(e)!==-1)throw new Error("Cannot subscribe more than once");return this.subscribers.push(e),this.createSubscription(e)},e.prototype.publish=function(e){for(var t=this.subscribers.map(function(e){return e}),n=0;n<t.length;n++)t[n](e);this.publishCount++},e.prototype.filter=function(t,n){void 0===n&&(n=null);var r=new e,o=this;return this.subscribe(function(e){t.call(n,e,o.publishCount,o)&&r.publish(e)}),r},e.prototype.waitFor=function(e){var t=this;return new r["default"](function(n){t.subscribe(function(t){o.DeepEqual.deepEqual(t,e)&&n(t)})})},e.prototype.nextValue=function(){var e=this;return new r["default"](function(t){var n=e.subscribe(function(e){n.dispose(),t(e)})})},e.prototype.dispatchAs=function(e,t){return this.subscribe(function(n){return t.dispatch(e(n))})},e.prototype.createSubscription=function(e){var t=this;return{dispose:function(){var n=t.subscribers.indexOf(e);n>-1&&t.subscribers.splice(n,1)}}},e}();n.Observable=i},{"./DeepEqual":12,"./Promise":18}],17:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("./Observable"),i=function(e){function t(t,n){var r=e.call(this)||this;return r.eventConverter=t,r.eventObservable=n,r.eventObservable.subscribe(function(e){r.publish(r.serialiseEvent(e))}),r}return r(t,e),t.prototype.serialiseEvent=function(e){return this.eventConverter.toSerialisable(e)},t}(o.Observable);n.ObservableEventSerialiser=i},{"./Observable":16}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./utils"),o=function(){function e(e){var t=this;if(this.status=i.PENDING,this.queue=[],"function"==typeof e)try{e(function(e){t.resolve(e)},function(e){t.reject(e)})}catch(n){this.reject(n)}}return e.resolve=function(t){return new e(function(n,r){"undefined"==typeof t?n(void 0):t instanceof e?t.then(n,r):n(t)})},e.reject=function(t){return new e(function(e,n){n(t)})},e.all=function(t){return 0===t.length?e.resolve([]):new e(function(e,n){var r=[],o=0;t.forEach(function(i,s){i.then(function(n){r[s]=n,o+=1,o===t.length&&e(r)},function(e){n(e)})})})},e.race=function(t){return new e(function(e,n){var r=!1;for(var o in t)t[o].then(function(t){r||(r=!0,e(t))},function(e){r||(r=!0,n(e))})})},e.prototype.then=function(t,n){var r={onFulfilled:t,onRejected:n,promise:new e};return this.queue.push(r),this.status===i.FULFILLED?this.resolve(this.resolution):this.status===i.REJECTED&&this.reject(this.error),r.promise},e.prototype["catch"]=function(e){return this.then(r.identity,e)},e.prototype.resolve=function(e){this.status=i.FULFILLED,this.resolution=e;var t=this.queue.shift();try{for(;t;){var n=t.onFulfilled(e);this.resolveValue(n,t),t=this.queue.shift()}}catch(r){setTimeout(function(){return t.promise.reject(r)},0)}},e.prototype.reject=function(e){this.status=i.REJECTED,this.error=e;var t=this.queue.shift();try{for(;t;){if("function"==typeof t.onRejected){var n=t.onRejected(e);this.resolveValue(n,t)}else setTimeout(t.promise.reject.bind(t.promise,e),0);t=this.queue.shift()}}catch(e){setTimeout(function(){return t.promise.reject(e)},0)}},e.prototype.timeout=function(t,n){return void 0===n&&(n="Promise timed out after "+t+"ms"),e.race([this,new e(function(e,r){setTimeout(function(){r(new Error(n))},t)})])},e.prototype.resolveValue=function(t,n){t instanceof e?t.then(function(e){setTimeout(n.promise.resolve.bind(n.promise,e),0)},function(e){setTimeout(n.promise.reject.bind(n.promise,e),0)}):setTimeout(n.promise.resolve.bind(n.promise,t),0)},e}();n["default"]=o;var i;!function(e){e[e.PENDING=0]="PENDING",e[e.REJECTED=1]="REJECTED",e[e.FULFILLED=2]="FULFILLED"}(i||(i={}))},{"./utils":29}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../list"),o=365,i=864e5,s=function(){function e(){}return e.generateCookieStr=function(t){var n;n=encodeURIComponent(t.content);var r,i=encodeURIComponent(t.name);return r="undefined"!=typeof t.expiration?t.expiration.toUTCString():e.calculateExpiryDate(o).toUTCString(),[i,"=",n,"; expires="+r,t.domain&&"; domain="+t.domain,t.path&&"; path="+t.path,t.httpOnly?"; httpOnly":"",t.secure?"; secure":""].join("")},e.parseCookieStr=function(e){var t=e?e.split("; "):[],n=t.map(function(e){var t=e.split("="),n=t[0],r=t.slice(1).join("=");'"'===r.charAt(0)&&(r=r.slice(1,-1));try{r=decodeURIComponent(r)}catch(o){}return{name:n,content:r}});return r.groupBy(n,r.property("name"))},e.calculateExpiryDate=function(e){var t=new Date;return t.setMilliseconds(t.getMilliseconds()+e*i),t},e}();n.CookieUtil=s},{"../list":26}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../events/EventTargetUtil"),o=e("../Observable");n.VALIDATION_ERROR_MSG="Dom Utils validation error";var i=function(){function e(e){this.documentLike=e}return e.prototype.drawByString=function(e,t){var n=this.documentLike.createElement("div");n.innerHTML=t.trim(),this.drawByElement(e,n.firstChild)},e.prototype.drawByElement=function(e,t){this.selectorHasMatches(e),this.documentLike.querySelector(e).appendChild(t)},e.prototype.style=function(e,t,n){this.selectorHasMatches(e);var r=this.documentLike.querySelector(e);r.style[t]=n},e.prototype.modifyAttribute=function(e,t,n){this.selectorHasMatches(e);var r=this.documentLike.querySelector(e);r.setAttribute(t,n)},e.prototype.modifyTextContent=function(e,t){this.selectorHasMatches(e);var n=this.documentLike.querySelector(e);n.textContent=t},e.prototype.listen=function(e,t,n){this.selectorHasMatches(e);for(var i=new o.Observable,s=this.documentLike.querySelectorAll(e),u=function(e){n&&e.preventDefault(),i.publish(e)},a=0;a<s.length;a++)r.EventTargetUtil.addEventListener(s[a],t,u);return i},e.prototype.scrape=function(e,t){for(var n=this,r=this.documentLike.querySelectorAll(e),o=t?function(e){return e.getAttribute(t)}:function(e){return n.elementText(e)},i=[],s=0;s<r.length;s++)i.push(o(r[s]));return i},e.prototype.getInputValue=function(e){var t=this.selectOnlyOneElement(e);if("undefined"==typeof t.value)throw new Error("selected element is not an input");return t.value},e.prototype.validateSelector=function(e){try{this.documentLike.querySelectorAll(e)}catch(t){return!1}return!0},e.prototype.getBoundingClientRect=function(e){var t=this.selectOnlyOneElement(e),n=t.getBoundingClientRect();return{top:n.top,bottom:n.bottom,left:n.left,right:n.right,height:n.height,width:n.width}},e.prototype.getReferrer=function(){return document.referrer},e.prototype.elementText=function(e){return e.textContent.replace(/\s+/g," ").replace(/\n/g," ")},e.prototype.selectorHasMatches=function(e){if(!this.documentLike.querySelector(e))throw new Error(n.VALIDATION_ERROR_MSG)},e.prototype.selectOnlyOneElement=function(e){var t=this.documentLike.querySelectorAll(e);if(1!==t.length)throw new Error("it should be only one element selected: got "+t.length);return t[0]},e}();n.DOMUtil=i},{"../Observable":16,"../events/EventTargetUtil":23}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../Promise"),o=e("../events/EventTargetUtil"),i=e("../Observable"),s=e("../CachingObservable");n.URL_PUBLISH_INTERVAL_MILLISECONDS=500,n.WINDOW_DIMENSION_CHECK_INTERVAL_MILLISECONDS=1e3;var u="complete";n.IS_IOS_11=window.navigator.appVersion&&window.navigator.appVersion.indexOf("iPhone OS 11")>=0;var a=function(){function e(e){this.windowLike=e}return e.prototype.listen=function(e){var t=new i.Observable,n=function(e){t.publish(e)};return o.EventTargetUtil.addEventListener(this.windowLike,e,n),t},e.prototype.observeLocation=function(){var e=this;if(!this.locationObservable){this.locationObservable=new s.CachingObservable;var t=function(){e.locationObservable.publishIfChanged(e.getLocation())};setInterval(t,n.URL_PUBLISH_INTERVAL_MILLISECONDS)}return this.locationObservable},e.prototype.getLocation=function(){return{hash:this.windowLike.location.hash,host:this.windowLike.location.host,hostname:this.windowLike.location.hostname,href:this.windowLike.location.href,pathname:this.windowLike.location.pathname,port:this.windowLike.location.port,protocol:this.windowLike.location.protocol,search:this.windowLike.location.search}},e.prototype.getInnerDimensions=function(){var e={height:this.windowLike.innerHeight,width:this.windowLike.innerWidth,deviceScale:this.windowLike.devicePixelRatio||1};return n.IS_IOS_11&&(e._iOS11_top=this.windowLike.scrollY),e},e.prototype.observeInnerDimensions=function(){var e=this;if(!this.dimensionsObservable){this.dimensionsObservable=new s.CachingObservable;var t=function(){e.dimensionsObservable.publishIfChanged(e.getInnerDimensions())};this.listen("resize").subscribe(t),n.IS_IOS_11&&this.listen("scroll").subscribe(t),setInterval(t,n.WINDOW_DIMENSION_CHECK_INTERVAL_MILLISECONDS)}return this.dimensionsObservable},e.prototype.assetsLoaded=function(){var e=this;return new r["default"](function(t){e.windowLike.document.readyState===u?t(void 0):e.listen("load").subscribe(function(e){t(void 0)})})},e.prototype.redirect=function(e){this.windowLike.location.href=e},e}();n.WindowUtil=a},{"../CachingObservable":11,"../Observable":16,"../Promise":18,"../events/EventTargetUtil":23}],22:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./SerialisableEvent"),o=e("./SerialisableMouseEvent");n.SERIALISATION_DESCS=[r.EVENT_SERIALISATION_DESC,o.MOUSEEVENT_SERIALISATION_DESC];var i=function(){function e(e){this.serialisationDescs=e}return e.prototype.toSerialisable=function(e){for(var t={},n=0,r=this.serialisationDescs;n<r.length;n++){var o=r[n];e instanceof o.ctor&&this.copyProperties(e,t,o.safeProps)}return t},e.prototype.copyProperties=function(e,t,n){for(var r=0,o=n;r<o.length;r++){var i=o[r];this.isPrimitive(e[i])&&(t[i]=e[i])}},e.prototype.isPrimitive=function(e){return["boolean","string","number"].indexOf(typeof e)>-1},e}();n.EventConverter=i},{"./SerialisableEvent":24,"./SerialisableMouseEvent":25}],23:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.addEventListener=function(t,n,r,o){if(e.isStandardsEventTarget(t))t.addEventListener(n,r,o);else{if(!e.isMSEventTarget(t))throw new TypeError("object is not an EventTarget");t.attachEvent("on"+n,r)}},e.removeEventListener=function(t,n,r,o){if(e.isStandardsEventTarget(t))t.removeEventListener(n,r,o);else{if(!e.isMSEventTarget(t))throw new TypeError("object is not an EventTarget");t.detachEvent("on"+n,r)}},e.isStandardsEventTarget=function(e){return"object"==typeof e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener&&"function"==typeof e.dispatchEvent},e.isMSEventTarget=function(e){return"object"==typeof e&&"function"==typeof e.attachEvent&&"function"==typeof e.detachEvent&&"function"==typeof e.fireEvent},e}();n.EventTargetUtil=r},{}],24:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.EVENT_SERIALISATION_DESC={ctor:Event,safeProps:["bubbles","cancelable","defaultPrevented","eventPhase","timeStamp","type","isTrusted"]}},{}],25:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MOUSEEVENT_SERIALISATION_DESC={ctor:MouseEvent,safeProps:["altKey","ctrlKey","metaKey","shiftKey","button","buttons","clientX","clientY","movementX","movementY","screenX","screenY"]}},{}],26:[function(e,t,n){"use strict";function r(e){for(var t=[],n=0,r=e;n<r.length;n++)for(var o=r[n],i=0,s=o;i<s.length;i++){var u=s[i];t.push(u)}return t}function o(e){return e.filter(function(e){return null!==e&&void 0!==e})}function i(e,t){return e.map(t)}function s(e){return function(t){return t.map(e)}}function u(e,t){var n=e.indexOf(t);return n===-1?e:(e=e.slice(),e.splice(n,1),e)}function a(e){return function(t){return u(t,e)}}function c(e,t){return f(e,[t])}function l(e){return p([e])}function f(e,t){return e.concat(t)}function p(e){return function(t){return t.concat(e)}}function d(e,t){for(var n=0,r=e.length;n<r&&t(e[n]);)n++;return e.slice(n,r)}function v(e,t){return e.filter(t)}function h(e){return function(t){return t.filter(e)}}function y(e,t){
if(0!==e.length){var n=d(e,function(e){return!t(e)});return g(n)}}function g(e){return e[0]}function b(e){return o(e)[0]}function m(e){return 0===e.length}function _(e){return e.slice(0).reverse()}function O(e,t){return e.slice(0,t)}function E(e){return function(t){return O(t,e)}}function w(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return!0;return!1}function M(e,t){return!w(e,function(e){return!t(e)})}function S(e){for(var t=Math.max.apply(Math,e.map(function(e){return e.length})),n=[],r=0;r<t;r++){for(var o=[],i=0,s=e;i<s.length;i++){var u=s[i];o.push(u[r])}n.push(o)}return n}function C(e,t){return j.dict(e.map(function(e){return{key:t(e),value:e}}))}function L(e,t){return j.dict(e.map(function(e){return{key:t(e),value:[e]}}),function(e,t){return{key:e.key,value:e.value.concat(t.value)}})}function P(e){return function(t){var n=t[e];return"string"==typeof n?n:T.stableStringify(n)}}function I(e,t){return e.slice(0).sort(t)}function R(e){return function(t,n){var r=e(t),o=e(n);return r<o?-1:r>o?1:0}}function A(e,t){return k.values({lowerBound:e,upperBound:t})}Object.defineProperty(n,"__esModule",{value:!0});var j=e("./Dictionary"),T=e("@yieldify/gendry-hash-util");n.flatten=r,n.compact=o,n.map=i,n._map=s,n.remove=u,n._remove=a,n.append=c,n._append=l,n.concat=f,n._concat=p,n.dropWhile=d,n.filter=v,n._filter=h,n.find=y,n.head=g,n.first=b,n.isEmpty=m,n.reverse=_,n.take=O,n._take=E,n.some=w,n.every=M,n.zip=S,n.indexBy=C,n._indexBy=function(e){return function(t){return C(t,e)}},n.groupBy=L,n._groupBy=function(e){return function(t){return L(t,e)}},n.property=P,n.sort=I,n._sort=function(e){return function(t){return I(t,e)}},n._compare=R;var k={values:function(e){for(var t=[],n=e.lowerBound;n<e.upperBound;n++)t.push(n);return t}};n.range=A},{"./Dictionary":13,"@yieldify/gendry-hash-util":51}],27:[function(e,t,n){"use strict";function r(e,t){return e}function o(e,t){return e===t}function i(e){return function(t,n){if(t===n)return!0;for(var r=Object.keys(t).concat(Object.keys(n)),o=0,i=r;o<i.length;o++){var s=i[o];if(!e(t[s],n[s]))return!1}return!0}}function s(e){return function(t,n){if(t===n)return!0;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!e(t[r],n[r]))return!1;return!0}}function u(e,t){var n,r,o=function(o){return void 0!==n&&t(o,n)||(r=e(o)),n=o,r};return o}function a(e,t,n,r){var o=0,i=n(function(e){return o++,t(e)},r),s=e(i);return s.resultFunc=t,s.recomputations=function(){return o},s.resetRecomputations=function(){o=0},s}function c(e,t,n,r){return void 0===n&&(n=u),void 0===r&&(r=o),a(function(t){return function(n){return t(e(n))}},t,n,r)}function l(e,t,n,r){return void 0===n&&(n=u),void 0===r&&(r=i(o)),a(function(t){return function(n){var r={};for(var o in e)r[o]=e[o](n);return t(r)}},t,n,r)}function f(e,t,n,r){return void 0===n&&(n=u),void 0===r&&(r=s(o)),a(function(t){return function(n){var r=e.map(function(e){return e(n)});return t(r)}},t,n,r)}function p(e,t){return l({state:function(e){return e},input:e},t,u,function(e,t){return e.input===t.input})}function d(e,t,n,r){void 0===n&&(n=u),void 0===r&&(r=o);var i={};return p(e,function(o){var s=o.state,u=o.input,a={},l=Object.keys(i),f=function(o){void 0===i[o]&&(i[o]=c(function(t){return e(t)[o]},t,n,r)),a[o]=i[o](s)};for(var p in u)f(p);for(var d=0,v=l;d<v.length;d++){var p=v[d];void 0===u[p]&&delete i[p]}return a})}function v(e,t){return l({index:e,map:t},function(e){for(var t=e.index,n=e.map,r=[],o=0,i=t;o<i.length;o++){var s=i[o];r.push(n[s])}return r})}function h(e,t){return l({key:e,obj:t},function(e){var t=e.key,n=e.obj;return n[t]})}function y(e){return function(t){return e(t)(t)}}function g(e){return a(function(t){return function(n){return t(e(n).map(function(e){return e(n)}))}},m.identity,u,s(o))}function b(e){return a(function(t){return function(n){var r=e(n),o={};for(var i in r)o[i]=r[i](n);return t(o)}},m.identity,u,i(o))}Object.defineProperty(n,"__esModule",{value:!0});var m=e("./utils");n.noopMemoise=r,n.strictEqualityCheck=o,n.objectEqualityCheck=i,n.listEqualityCheck=s,n.selector=c,n.mapSelector=l,n.listSelector=f,n.transformDict=d,n.materialise=v,n.pluck=h,n.lift=y,n.liftList=g,n.liftDict=b},{"./utils":29}],28:[function(e,t,n){"use strict";function r(e){function t(e,n){function r(r){function o(e,t){return void 0===t&&(t=!1),n(function(n){var o=e(u);return o===u?n:!t&&s.DeepEqual.deepEqual(o,u)?n:i({},n,(a={},a[r]=o,a));var a},!0)}var u=e[r];return{get:t(u,o),set:o}}return r}var n=function(t,n){return void 0===n&&(n=!1),t(e)};return{get:t(e,n),set:n}}function o(e){return function(t){return i({},t,e(t))}}var i=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};Object.defineProperty(n,"__esModule",{value:!0});var s=e("./DeepEqual");n.update=r,n.partial=o},{"./DeepEqual":12}],29:[function(e,t,n){"use strict";function r(e){return"number"==typeof e&&!isNaN(e)}function o(e){g=new RegExp("(^#|.*&)"+_+"($|&.*)").test(e.location.hash)}function i(){g=!1}function s(){return g}function u(e){return g===!1?e:e.indexOf("#")>=0?e+"&"+_:e+"#"+_}function a(e){return e.location.hash?e.location.hash.substring(1):""}function c(e,t){return t?e.indexOf("#")>=0?e+"&"+t:e+"#"+t:e}function l(e){var t={};for(var n in e){if(e[n]in e)throw new Error('Value "'+e[n]+'" is already a key in the lookup table');t[n]=e[n],t[e[n]]=n}return t}function f(e){return null!==e&&"object"==typeof e?e instanceof Array?e.slice():y({},e):e}function p(e){if(!e||0===e.length)return"";var t=e.reduce(function(e,t){return e+(t===!0?"1":"0")},""),n=parseInt(t,2),r=n.toString(36);return r}function d(e,t){if(""===e){if(0!==t)throw new Error("More bits than expected are encoded");return[]}var n=parseInt(e,36),r=n.toString(2),o=r.split("").map(function(e){return"1"===e}),i=t-o.length;if(isNaN(n))throw new Error("Input not parsable into base 36");if(i<0)throw new Error("More bits than expected are encoded");var s=v(i,!1);return s.concat(o)}function v(e,t){var n=Array.apply(null,Array(e));return n.map(function(){return t})}function h(e){var t=b.map(m.entries(e),function(e){return e.key+":"+e.value});return t.join(";")}var y=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};Object.defineProperty(n,"__esModule",{value:!0});var g,b=e("./list"),m=e("./Dictionary"),_="yidebug";n.isValidNumber=r,n.initialiseDebugMode=o,n.resetDebugMode=i,n.isDebugMode=s,n.addDebugParameter=u,n.getHash=a,n.addHashParameters=c,n.createTranslationTable=l,n.shallowClone=f,n.identity=function(e){return e},n.noop=function(){},n.notNull=function(e){return null!==e},n.toBitVector=p,n.fromBitVector=d,n.generateCssText=h},{"./Dictionary":13,"./list":26}],30:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../lib/Promise"),o=function(){function e(){this.registry=void 0}return e.methodNotImplemented=function(e){return function(){return r["default"].reject(new Error(e+" is not implemented by this module"))}},e.prototype.setRegistry=function(e){this.registry=e},e.prototype.invokeMethod=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.validateCall(e),!this.registry)throw new Error("Registry has not been defined");return(r=this.registry).invokeMethod.apply(r,[this.getRoutingLabel(),e].concat(t));var r},e.prototype.invokeStream=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.validateCall(e),!this.registry)throw new Error("Registry has not been defined");return(r=this.registry).invokeStream.apply(r,[this.getRoutingLabel(),e].concat(t));var r},e.prototype.toJSON=function(){return{label:this.getRoutingLabel()}},e.prototype.validateCall=function(e){if("function"!=typeof this["interface"]()[e])throw new Error("Invoked method is not part of the interface")},e}();n.BaseModule=o},{"../../lib/Promise":18}],31:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.modules={}}return e.prototype.register=function(e){var t=e.getRoutingLabel();if(t in this.modules)throw new Error("Cannot register two modules with the same routing label: "+t);this.modules[e.getRoutingLabel()]=e,e.setRegistry(this)},e.prototype.registerAll=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];this.register(r)}},e.prototype.getModuleByClass=function(e){for(var t in this.modules){var n=this.getModuleByLabel(t);if(n instanceof e)return n}},e.prototype.getModuleByLabel=function(e){return this.modules[e]},e.prototype.toJSON=function(){return{modules:this.modules}},e}();n.ModuleRegistry=r},{}],32:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("../BaseModule"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getRoutingLabel=function(){return"cookie"},t.prototype["interface"]=function(){return{getCookie:this.getCookie,getCookies:this.getCookies,setCookie:this.setCookie,deleteCookie:this.deleteCookie}},t}(o.BaseModule);n.CookieBase=i},{"../BaseModule":30}],33:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("./Base"),i=e("../../../lib/browser/CookieUtil"),s=e("../../../lib/Promise"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.setCookie=function(e){try{return document.cookie=i.CookieUtil.generateCookieStr(e),s["default"].resolve()}catch(t){return s["default"].reject(t)}},t.prototype.deleteCookie=function(e,t){var n=new Date;return n.setTime(0),this.setCookie({name:e,content:"",domain:t||void 0,path:"/",expiration:n})},t.prototype.getCookie=function(e){try{var t=i.CookieUtil.parseCookieStr(document.cookie)[e]||[];return s["default"].resolve(t[0])}catch(n){return s["default"].reject(n)}},t.prototype.getCookies=function(e){try{return s["default"].resolve(i.CookieUtil.parseCookieStr(document.cookie)[e]||[])}catch(t){return s["default"].reject(t)}},t}(o.CookieBase);n.CookieHost=u},{"../../../lib/Promise":18,"../../../lib/browser/CookieUtil":19,"./Base":32}],34:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("../BaseModule"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getRoutingLabel=function(){return"dom"},t.prototype["interface"]=function(){return{draw:this.draw,style:this.style,modifyAttribute:this.modifyAttribute,listen:this.listen,createValueScraper:this.createValueScraper,startScraping:this.startScraping,stopScraping:this.stopScraping,getInputValue:this.getInputValue,getReferrer:this.getReferrer,getBoundingClientRect:this.getBoundingClientRect}},t}(o.BaseModule);n.DOMBase=i},{"../BaseModule":30}],35:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("./Base"),i=e("../../../app/model/page/scraper/ValueScraper"),s=e("../../../lib/ObservableEventSerialiser"),u=e("../../../lib/Observable"),a=e("../../../lib/AsyncWorker"),c=e("../../../lib/Promise"),l=function(e){function t(t,n){var r=e.call(this)||this;return r.domUtil=t,r.eventConverter=n,r.valueScraperMap={},r.scraperId=0,r}return r(t,e),t.prototype.draw=function(e,t){try{return this.domUtil.drawByString(e,t),c["default"].resolve()}catch(n){return c["default"].reject(n)}},t.prototype.style=function(e,t,n){try{return this.domUtil.style(e,t,n),c["default"].resolve()}catch(r){return c["default"].reject(r)}},t.prototype.modifyAttribute=function(e,t,n){try{return this.domUtil.modifyAttribute(e,t,n),c["default"].resolve()}catch(r){return c["default"].reject(r)}},t.prototype.listen=function(e,t,n){try{return new s.ObservableEventSerialiser(this.eventConverter,this.domUtil.listen(e,t,n))}catch(r){return new u.Observable}},t.prototype.createValueScraper=function(e,t){try{var n=this.nextScraperId(),r=new i.ValueScraper(this.domUtil,new a.AsyncWorker,e,t);return this.valueScraperMap[n]=r,c["default"].resolve(n)}catch(o){return c["default"].reject(o)}},t.prototype.startScraping=function(e){var t=this.getValueScraper(e);return t.start(),t.getValuesObservable()},t.prototype.stopScraping=function(e){try{return this.getValueScraper(e).stop(),c["default"].resolve()}catch(t){return c["default"].reject(t)}},t.prototype.getInputValue=function(e){try{return c["default"].resolve(this.domUtil.getInputValue(e))}catch(t){return c["default"].reject(t)}},t.prototype.getReferrer=function(){try{return c["default"].resolve(this.domUtil.getReferrer())}catch(e){return c["default"].reject(e)}},t.prototype.getBoundingClientRect=function(e){try{return c["default"].resolve(this.domUtil.getBoundingClientRect(e))}catch(t){return c["default"].reject(t)}},t.prototype.nextScraperId=function(){return this.scraperId+=1},t.prototype.getValueScraper=function(e){return this.valueScraperMap[e]},t}(o.DOMBase);n.DOMHost=l},{"../../../app/model/page/scraper/ValueScraper":6,"../../../lib/AsyncWorker":9,"../../../lib/Observable":16,"../../../lib/ObservableEventSerialiser":17,"../../../lib/Promise":18,"./Base":34}],36:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("../BaseModule");n.CREATE_IFRAME_METHOD="createIFrame",n.START_PROXYING_METHOD="startProxying",n.SEND_METHOD="send",n.RECEIVE_METHOD="receive";var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getRoutingLabel=function(){return"iframe"},t}(o.BaseModule);n.IFrameBase=i},{"../BaseModule":30}],37:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../../lib/Promise"),i=e("../../../lib/Logger"),s=e("../BaseModule"),u=e("./Base"),a=function(e){function t(t){var n=e.call(this)||this;return n.iframeCreator=t,n.connections={},n.numConnections=0,n}return r(t,e),t.prototype.createIFrame=function(e){var t=this;return this.iframeCreator.create(e).then(function(e){var n=t.numConnections++;return t.connections[n]=e,o["default"].resolve(n)})},t.prototype.startProxying=function(e){var t=this;try{this.getConnection(e).receive(function(n){t.proxyReceivedData(e,n)})}catch(n){throw i.logger.error({error:n,connectionId:e},"Erroring starting to proxy connection"),n}},t.prototype.send=function(e,t){try{this.getConnection(e).send(t)}catch(n){throw i.logger.error({error:n,connectionId:e,data:t},"Error attempting to send data to connection"),n}},t.prototype["interface"]=function(){var e=this;return t={},t[u.CREATE_IFRAME_METHOD]=function(t){return e.createIFrame(t)},t[u.START_PROXYING_METHOD]=function(t){return new o["default"](function(n){n(e.startProxying(t))})},t[u.SEND_METHOD]=function(t,n){return new o["default"](function(r){return r(e.send(t,n))})},t[u.RECEIVE_METHOD]=s.BaseModule.methodNotImplemented(u.RECEIVE_METHOD),t;var t},t.prototype.getConnection=function(e){var t=this.connections[e];if(t)return t;throw new Error("Non-existent iframe connection id")},t.prototype.proxyReceivedData=function(e,t){return this.invokeMethod(u.RECEIVE_METHOD,e,t)},t}(u.IFrameBase);n.IFrameHost=a},{"../../../lib/Logger":15,"../../../lib/Promise":18,"../BaseModule":30,"./Base":36}],38:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("../BaseModule"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getRoutingLabel=function(){return"localStorage"},t.prototype["interface"]=function(){return{getItem:this.getItem,setItem:this.setItem,removeItem:this.removeItem}},t}(o.BaseModule);n.LocalStorageBase=i},{"../BaseModule":30}],39:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("./Base"),i=e("../../../lib/Promise"),s=function(e){function t(t){var n=e.call(this)||this;return n.localStorage=t,n}return r(t,e),t.prototype.setItem=function(e,t){try{return this.localStorage.setItem(e,t),i["default"].resolve()}catch(n){return i["default"].reject(n)}},t.prototype.getItem=function(e){try{return i["default"].resolve(this.localStorage.getItem(e))}catch(t){return i["default"].reject(t)}},t.prototype.removeItem=function(e){try{return i["default"].resolve(this.localStorage.removeItem(e))}catch(t){return i["default"].reject(t)}},t}(o.LocalStorageBase);n.LocalStorageHost=s},{"../../../lib/Promise":18,"./Base":38}],40:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("../BaseModule"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getRoutingLabel=function(){return"window"},t.prototype["interface"]=function(){return{listen:this.listen,observeLocation:this.observeLocation,getInnerDimensions:this.getInnerDimensions,observeInnerDimensions:this.observeInnerDimensions,redirect:this.redirect}},t}(o.BaseModule);n.WindowBase=i},{"../BaseModule":30}],41:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../../lib/ObservableEventSerialiser"),i=e("../../../lib/Promise"),s=e("./Base"),u=function(e){function t(t,n){var r=e.call(this)||this;return r.windowUtil=t,r.eventConverter=n,r}return r(t,e),t.prototype.listen=function(e){return new o.ObservableEventSerialiser(this.eventConverter,this.windowUtil.listen(e))},t.prototype.observeLocation=function(){return this.windowUtil.observeLocation()},t.prototype.getInnerDimensions=function(){return i["default"].resolve(this.windowUtil.getInnerDimensions())},t.prototype.observeInnerDimensions=function(){return this.windowUtil.observeInnerDimensions()},t.prototype.redirect=function(e){var t=this;return new i["default"](function(n,r){try{t.windowUtil.redirect(e),n(void 0)}catch(o){r(o)}})},t}(s.WindowBase);n.WindowHost=u},{"../../../lib/ObservableEventSerialiser":17,"../../../lib/Promise":18,"./Base":40}],42:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../lib/Promise"),o=e("../../lib/events/EventTargetUtil"),i=e("./connection/CrossOriginConnection"),s=e("./HandshakeMessage"),u=function(){function e(e){this.source=e}return e.prototype.listen=function(e){var t=this;return new r["default"](function(n,r){var u=function(r){if(r.source===e.contentWindow&&r.data===s.HandshakeMessage.CONNECT){o.EventTargetUtil.removeEventListener(t.source,"message",u,!0);var a=new i.CrossOriginConnection(t.source,e.contentWindow);a.send(s.HandshakeMessage.READY),n(a)}};o.EventTargetUtil.addEventListener(t.source,"message",u,!0)})},e}();n.CrossOriginServer=u},{"../../lib/Promise":18,"../../lib/events/EventTargetUtil":23,"./HandshakeMessage":43,"./connection/CrossOriginConnection":48}],43:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.HandshakeMessage={CONNECT:"CONNECT",READY:"READY"}},{}],44:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../lib/Promise"),o=e("../../lib/Logger"),i=function(){function e(e,t,n,r){this.crossOriginServer=e,this.json=t,this.domUtil=r,this.doc=n}return e.prototype.create=function(e){var t=this.doc.createElement("iframe");t.src=e.src,t.name=e.name,t.style.display="none";var n=this.crossOriginServer.listen(t);try{this.domUtil.drawByElement(e.parentElement,t)}catch(i){return o.logger.error({selector:e.parentElement,error:i},"Unable to append iframe to the DOM"),r["default"].reject(i)}return n},e}();n.IFrameCreator=i},{"../../lib/Logger":15,"../../lib/Promise":18}],45:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../lib/Promise"),i=e("../../lib/Observable"),s=e("../../lib/Logger"),u=e("./RemoteWindowMessage"),a=e("./connection/JSONConnection"),c=e("../modules/ModuleRegistry"),l=function(e){function t(t){var n=e.call(this)||this;return n.responseCallbacks={},n.connection=t,n.messageId=0,n.config=void 0,n.startReceived=!1,n}return r(t,e),t.connect=function(e,n){return void 0===n&&(n={}),function(r){var o=new a.JSONConnection(e,r),i=new t(o);return n.provide&&i.registerAll(n.provide),i.start(n.initConfig)}},t.prototype.start=function(e){var t=this;return new o["default"](function(n,r){t.connection.receive(function(e){if(t.startReceived)t.handler(e);else try{t.parseStartMessage(e),n(t)}catch(o){r(o)}}),t.connection.send({id:0,type:u.MessageType.START,target:"-",method:"-",data:e})})},t.prototype.getConfig=function(){return this.config},t.prototype.invokeMethod=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=new o["default"];return this.invoke.apply(this,[i,e,t].concat(n)),i},t.prototype.invokeStream=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=new i.Observable;return this.invoke.apply(this,[o,e,t].concat(n)),o},t.prototype.toJSON=function(){return{config:this.config}},t.prototype.invoke=function(e,t,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];var i=this.nextMessageId();this.connection.send({id:i,type:u.MessageType.CALL,target:t,method:n,data:r}),this.responseCallbacks[i]=e},t.prototype.parseStartMessage=function(e){if(e.type!==u.MessageType.START)throw new Error("Received a non-START message while waiting for START");this.startReceived=!0,this.config=e.data},t.prototype.respond=function(e,t){this.connection.send({id:e.id,type:u.MessageType.RESPONSE,target:e.target,method:e.method,data:t})},t.prototype.respondError=function(e,t){this.connection.send({id:e.id,type:u.MessageType.ERROR,target:e.target,method:e.method,data:t.message})},t.prototype.handleCall=function(e){var t=this;this.validateCall(e);var n=this.getModuleByLabel(e.target),r=n["interface"]()[e.method].apply(n,e.data),u=function(n){t.respond(e,n)},a=function(n){s.logger.debug({error:n},"Call resulted in an error"),t.respondError(e,n)};if(r instanceof o["default"]){var c=r;c.then(u,a)}else if(r instanceof i.Observable){var l=r;l.subscribe(u)}},t.prototype.handleResponse=function(e){this.validateResponse(e);var t=this.responseCallbacks[e.id];if(t instanceof o["default"]){var n=t;delete this.responseCallbacks[e.id],n.resolve(e.data)}else if(t instanceof i.Observable){var r=t;r.publish(e.data)}},t.prototype.handleError=function(e){this.validateResponse(e);var t=this.responseCallbacks[e.id];t instanceof o["default"]?(t.reject(new Error(e.data)),delete this.responseCallbacks[e.id]):s.logger.error({message:e},"Cant pass error message to observable")},t.prototype.handler=function(e){if(e.type===u.MessageType.CALL)this.handleCall(e);else if(e.type===u.MessageType.RESPONSE)this.handleResponse(e);else{if(e.type!==u.MessageType.ERROR)throw new Error("Invalid message type");this.handleError(e)}},t.prototype.nextMessageId=function(){return this.messageId+=1},t.prototype.validateCall=function(e){if(!e.id||isNaN(e.id))throw new Error("message does not contain a valid id");if(!e.target)throw new Error("message does not contain a valid target");if(!this.getModuleByLabel(e.target))throw new Error("message does not contain a valid target of: "+e.target);if("function"!=typeof this.getModuleByLabel(e.target)["interface"]()[e.method])throw new Error("method should be a valid function: "+e.method)},t.prototype.validateResponse=function(e){if(!e.id||isNaN(e.id))throw new Error("message does not contain a valid id")},t}(c.ModuleRegistry);n.RemoteWindow=l},{"../../lib/Logger":15,"../../lib/Observable":16,"../../lib/Promise":18,"../modules/ModuleRegistry":31,"./RemoteWindowMessage":46,"./connection/JSONConnection":49}],46:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r;!function(e){e[e.START=0]="START",e[e.CALL=1]="CALL",e[e.RESPONSE=2]="RESPONSE",e[e.ERROR=3]="ERROR"}(r=n.MessageType||(n.MessageType={}))},{}],47:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../../lib/Promise"),o=e("../../../lib/BufferingObservable"),i=e("../../../lib/DeepEqual"),s=function(){function e(){this.messages=new o.BufferingObservable}return e.prototype.receive=function(e){return this.messages.subscribe(e)},e.prototype.awaitMessage=function(e){var t=this;return new r["default"](function(n,r){var o=t.receive(function(s){i.DeepEqual.deepEqual(e,s)?(n(t),o.dispose()):r(new Error("Unexpected message received: "+s))})})},e.prototype.receivedMessage=function(e){this.messages.publish(e)},e}();n.Connection=s},{"../../../lib/BufferingObservable":10,"../../../lib/DeepEqual":12,"../../../lib/Promise":18}],48:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../../lib/events/EventTargetUtil"),i=e("./Connection"),s=e("../../../lib/Logger");n.ORIGIN_WILDCARD="*",n.MSG_PREFIX="/* yieldify */ ";var u=function(e){function t(t,n){var r=e.call(this)||this;return r.source=t,r.target=n,o.EventTargetUtil.addEventListener(t,"message",function(e){r.messageHandler(e)},!1),r}return r(t,e),t.prototype.send=function(e){var t=n.MSG_PREFIX+e;this.target.postMessage(t,n.ORIGIN_WILDCARD)},t.prototype.messageHandler=function(e){var t,r=e.origin,o=e.data;if(e.source===this.target)if("string"!=typeof o)s.logger.warn({origin:r},"CrossOriginConnection received a message with non-string data"),s.logger.debug({message:o},"Message with non-string data");else{var i=o.slice(0,n.MSG_PREFIX.length);i!==n.MSG_PREFIX?(s.logger.warn({origin:r},"CrossOriginConnection received a message without a prefix"),s.logger.debug({message:o},"Message without a prefix")):(t=o.slice(n.MSG_PREFIX.length),this.receivedMessage(t))}},t}(i.Connection);n.CrossOriginConnection=u},{"../../../lib/Logger":15,"../../../lib/events/EventTargetUtil":23,"./Connection":47}],49:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../../lib/Logger"),i=e("./Connection"),s=function(e){function t(t,n){var r=e.call(this)||this;return r.json=t,r.underlyingConnection=n,r.underlyingConnection.receive(function(e){r.stringMessageHandler(e)}),r}return r(t,e),t.prototype.send=function(e){this.underlyingConnection.send(this.json.stringify(e))},t.prototype.stringMessageHandler=function(e){var t;try{t=this.json.parse(e)}catch(n){return void o.logger.error({message:e},"Unable to parse received message as JSON")}this.receivedMessage(t)},t}(i.Connection);n.JSONConnection=s},{"../../../lib/Logger":15,"./Connection":47}],50:[function(e,t,n){"use strict";function r(e){var t=i.stableStringify(e);if(t)return o.murmur32(t,s)}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./murmurHash"),i=e("./stableStringify"),s=5297;n.deepHash=r},{"./murmurHash":52,"./stableStringify":53}],51:[function(e,t,n){"use strict";function r(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}Object.defineProperty(n,"__esModule",{value:!0}),r(e("./deepHash")),r(e("./murmurHash")),r(e("./stableStringify"))},{"./deepHash":50,"./murmurHash":52,"./stableStringify":53}],52:[function(e,t,n){"use strict";function r(e,t){if("undefined"==typeof e)throw new Error("key must be a valid string");if(t<1)throw new Error("seed must be a positive integer");if(e.split("").some(function(e){return e.charCodeAt(0)>127}))throw new Error("key must be an ascii string");for(var n,r,o=3&e.length,i=e.length-o,s=t,u=3432918353,a=461845907,c=0;c<i;)n=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,n=(65535&n)*u+(((n>>>16)*u&65535)<<16)&4294967295,n=n<<15|n>>>17,n=(65535&n)*a+(((n>>>16)*a&65535)<<16)&4294967295,s^=n,s=s<<13|s>>>19,r=5*(65535&s)+((5*(s>>>16)&65535)<<16)&4294967295,s=(65535&r)+27492+(((r>>>16)+58964&65535)<<16);switch(n=0,o){case 3:n^=(255&e.charCodeAt(c+2))<<16;case 2:n^=(255&e.charCodeAt(c+1))<<8;case 1:n^=255&e.charCodeAt(c),n=(65535&n)*u+(((n>>>16)*u&65535)<<16)&4294967295,n=n<<15|n>>>17,n=(65535&n)*a+(((n>>>16)*a&65535)<<16)&4294967295,s^=n}return s^=e.length,s^=s>>>16,s=2246822507*(65535&s)+((2246822507*(s>>>16)&65535)<<16)&4294967295,
s^=s>>>13,s=3266489909*(65535&s)+((3266489909*(s>>>16)&65535)<<16)&4294967295,s^=s>>>16,s>>>0}Object.defineProperty(n,"__esModule",{value:!0}),n.MURMUR_32_MAX_VALUE=4294967295,n.murmur32=r},{}],53:[function(e,t,n){"use strict";function r(e,t){if(void 0===t&&(t=[]),e&&e.toJSON&&"function"==typeof e.toJSON&&(e=e.toJSON()),"undefined"!=typeof e){if(null===e)return"null";if("object"!=typeof e)return JSON.stringify(e);if(t.indexOf(e)!==-1)throw new TypeError("Converting circular structure to JSON");if(t.push(e),o(e)){var n=e.map(function(e){var n=r(e,t)||"null";return n});return"["+n.join(",")+"]"}for(var i=Object.keys(e).sort(),s=[],u=0;u<i.length;u++){var a=i[u],c=r(e[a],t);c&&s.push(JSON.stringify(a)+":"+c)}return t.splice(t.indexOf(e),1),"{"+s.join(",")+"}"}}function o(e){return Array.isArray(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.stableStringify=r},{}]},{},[3]);