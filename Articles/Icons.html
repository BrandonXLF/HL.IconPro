<!DOCTYPE html>
<!-- saved from url=(0053)http://msdn.microsoft.com/en-us/library/ms997538.aspx -->
<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="WT.seg_1" content="en-us"><link rel="canonical" href="./Icons_files/Icons.html">
        <title>Icons</title>
        
        






<meta name="DCS.dcsuri" content="/en-us/library/ms997538(d=default,l=en-us,v=msdn.10).aspx">

<meta name="NormalizedUrl" content="http://msdn.microsoft.com/en-us/library/ms997538(d=default,l=en-us,v=msdn.10).aspx">

<meta name="ms.normalizedurl" content="http://msdn.microsoft.com/en-us/library/ms997538(d=default,l=en-us,v=msdn.10).aspx">

<meta name="VotingContextUrl" content="http://msdn.microsoft.com/en-us/library/ms997538(d=default,l=en-us,v=msdn.10).aspx">

<meta name="MN" content="FB361393-12:30:26 PM">

<meta name="Search.ShortId" content="ms997538">

<meta name="ms.shortidmsdn" content="ms997538">

<meta name="Ms.Locale" content="en-us">

<meta name="ms.prodver" content="MSDN.10">

<meta name="ms.contentlang" content="EN">

<meta name="ms.lang" content="EN">

<meta name="ms.loc" content="US">

<meta name="ms.sitever" content="2014.11.14.1">

<meta name="ms.assetid" content="MSDN|dnwui|~\html\msdn_icons.htm">

<meta name="ms.auth" content="1">








        
    <link rel="stylesheet" type="text/css" href="./Icons_files/Combined.css"><script type="text/javascript" async="" src="./Icons_files/ms2.js"></script><script type="text/javascript" src="./Icons_files/ai.js" async=""></script><script class="mtps-injected">try {
/**/
(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { 
	"image": "http://i.msdn.microsoft.com", 
	"js": "http://i2.msdn.microsoft.com", 
	"css": "http://i3.msdn.microsoft.com", 
	"xap": "http://msdn.microsoft.com"
});
/**/
} finally { MTPS._injectNextScript_0 && MTPS._injectNextScript_0(); }</script><script class="mtps-injected" src="./Icons_files/jquery-1.8.2.min.js"></script><script class="mtps-injected">try {
//
  var literalNormalizedUrl = '/en-us/library/ms997538(l=en-us,v=msdn.10).aspx';
  var wt_nvr_ru = 'WT_NVR_RU';
  var wt_fpcdom = '.microsoft.com';
  var wt_domlist = 'msdn.microsoft.com';
  var wt_pathlist = '';
  var wt_paramlist = 'DCSext.mtps_devcenter';
  var wt_siteid = 'MSDN';
  var gDomain = 'm.webtrends.com';
  var gDcsId = 'dcsmgru7m99k7mqmgrhudo0k8_8c6m';
  var gFpc = 'WT_FPC';



  if (document.cookie.indexOf(gFpc + "=") == -1) {
    var wtidJs = document.createElement("script");
    wtidJs.src = "//" + gDomain + "/" + gDcsId + "/wtid.js";
    document.getElementsByTagName("head")[0].appendChild(wtidJs);
  }



  var detectedLocale = 'en-us';
  var wtsp = 'msdnlib_w32_com';
  var gTrackEvents = '0';
/**/
} finally { MTPS._injectNextScript_2 && MTPS._injectNextScript_2(); }</script><script class="mtps-injected">try {
/**/
  var omni_guid = "1d9f847b-4ffe-44c3-acc7-e07daa1c8110";
/**/
} finally { MTPS._injectNextScript_3 && MTPS._injectNextScript_3(); }</script><script class="mtps-injected">try {
//

            window.appInsightsId = '60854590-027a-4ae4-98be-2741a40f355f';
            //
} finally { MTPS._injectNextScript_4 && MTPS._injectNextScript_4(); }</script><script class="mtps-injected" src="./Icons_files/Combined.js"></script><script class="mtps-injected" src="./Icons_files/SearchBox.jss"></script><script class="mtps-injected" src="./Icons_files/Combined(1).js"></script><script src="./Icons_files/broker.js"></script><script class="mtps-injected">try {
$(document).ready(function() {
        try {
            var token = $("#globalRequestVerification input[name='__RequestVerificationToken']").clone();
            $("#siteFeedbackForm").append(token);
        } catch(err) {
            
        }
    });
} finally { MTPS._injectNextScript_8 && MTPS._injectNextScript_8(); }</script><link href="./Icons_files/PrintView.css" rel="stylesheet" type="text/css" media="print"></head>
    <body class="library Chrome">
        <div id="page">
            
            
            
            
    

    
    <link type="text/css" rel="stylesheet">
    
    <input type="hidden" id="isHeaderBleeding" value="true">
    <div id="ux-header" dir="ltr" class="ltr msdn">
        

        <header>
            <div class="row">
                <div class="top mobile"></div>
                <div class="left">
                    <div class="siteLogo">  
                        
                            <a class="msdnLogoImg" href="http://msdn.microsoft.com/en-us">
                               <img src="./Icons_files/microsoftLogoForHeader.png">
                            </a>
                                                             
                        <div data-fragmentname="SiteLogo" id="Fragment_SiteLogo" xmlns="http://www.w3.org/1999/xhtml">
  <div class="LinkWithImage topImage">
    <a id="SiteLogo_2152_1" href="http://msdn.microsoft.com/">
      <img id="msdnLogo-black" src="./Icons_files/dn610975.msdnLogo-black.jpg" xmlns="">
      <span></span>
    </a>
  </div>
</div>    

                    </div>
                    <a id="grip" href="javascript:void(0)"></a>
                </div>
                
                <div class="right desktop">
                    <div class="auxNav">
                        <div id="signIn">
<a class=" createProfileLink" href="http://social.msdn.microsoft.com/profile/herbert%20%20lausmann/" title="Herbert  Lausmann">Herbert  Lausmann</a>
<a class="scarabLink" href="http://login.live.com/logout.srf?ct=1417293027&rver=6.0.5276.0&lc=1033&id=254354&ru=http%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fms997538.aspx&mkt=en-US" title="Sign out">Sign out</a></div>

    

                        <div data-fragmentname="Subscriptions" id="Fragment_Subscriptions" xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/subscriptions/manage/hh442900" id="Subscriptions_2153_1" xmlns="http://www.w3.org/1999/xhtml">MSDN subscriptions</a>
</div>   
                        <div data-fragmentname="GetTools" id="Fragment_GetTools" xmlns="http://www.w3.org/1999/xhtml">
  <a href="http://go.microsoft.com/fwlink/?LinkId=309297&clcid=0x409&slcid=0x409" id="GetTools_2153_3" xmlns="http://www.w3.org/1999/xhtml">Get tools</a>
</div>
                        <div data-fragmentname="SocialLinks" id="Fragment_SocialLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <ul class="links horizontal">
      <li>
        <a href="http://www.facebook.com/microsoftdeveloper" target="_blank" id="SocialLinks_2152_4" class="facebook" xmlns="http://www.w3.org/1999/xhtml">http://www.facebook.com/microsoftdeveloper</a>
      </li>
      <li>
        <a href="https://twitter.com/msdev" target="_blank" id="SocialLinks_2152_5" class="twitter" xmlns="http://www.w3.org/1999/xhtml">https://twitter.com/msdev</a>
      </li>
      <li>
        <a href="http://plus.google.com/111221966647232053570/" target="_blank" id="SocialLinks_2152_6" class="googlePlus" xmlns="http://www.w3.org/1999/xhtml">http://plus.google.com/111221966647232053570/</a>
      </li>
    </ul>
  </div>
</div> 
                    </div>
                    <div data-fragmentname="SearchBox" id="Fragment_SearchBox" xmlns="http://www.w3.org/1999/xhtml">
  <div class="SearchBox">
    <form id="HeaderSearchForm" name="HeaderSearchForm" method="get" onsubmit="return Epx.Controls.SearchBox.searchBoxOnSubmit(this);">
      <input id="HeaderSearchTextBox" name="query" type="text" maxlength="200" onfocus="Epx.Controls.SearchBox.watermarkFocus(event, this.title)" onblur="Epx.Controls.SearchBox.watermarkBlur(event, this.title)" autocomplete="off">
      <button id="HeaderSearchButton" value="" type="submit" class="header-search-button" title="Search MSDN"></button>
    <div id="SearchFlyoutContainer" style="display: none; text-align: left; border: 1px solid buttonshadow; position: absolute; z-index: 1000; padding: 2px; color: rgb(59, 59, 59); font-family: Arial; font-size: 13px; background-color: rgb(255, 255, 255);"><div id="SuggestionContainer"><ul style="list-style: none; padding: 4px 2px 0px 1px; cursor: pointer; margin: 1px; white-space: nowrap;"></ul></div></div></form>
    
    
  </div>
</div> 
                </div>
            </div>
       
             <div class="row" id="droor" style="display: block;">
                <div class="left toc">
                    
        <nav>
            <ul class="navL1">
                        <li class="inactive toggle">
                            <a href="javascript:void(0)" title="Technologies">Technologies</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive">
                                            <a href="http://msdn.microsoft.com/cloud-app-development-msdn" title="Cloud">Cloud</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://msdn.microsoft.com/mobile-app-development-msdn" title="Mobile">Mobile</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://msdn.microsoft.com/web-app-development-msdn" title="Web">Web</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://msdn.microsoft.com/business-and-productivity-app-development-msdn" title="Business">Business</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://msdn.microsoft.com/big-data-development-msdn" title="Data">Data</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://msdn.microsoft.com/games-development-msdn" title="Gaming">Gaming</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)" title="Downloads">Downloads</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive">
                                            <a href="http://www.visualstudio.com/downloads/download-visual-studio-vs" title="Visual Studio">Visual Studio</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://msdn.microsoft.com/subscriptions/" title="MSDN subscriptions">MSDN subscriptions</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://msdn.microsoft.com/microsoft-sdks-msdn" title="SDKs">SDKs</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)" title="Programs">Programs</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive">
                                            <a href="http://www.microsoft.com/bizspark" title="BizSpark">BizSpark</a>

                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="Students">Students</a>

                                                <ul class="navL3" style="display: none;">
                                                        <li class="inactive">
                                                            <a href="http://msdn.microsoft.com/students-overview-msdn" title="Overview">Overview</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://blogs.msdn.com/b/microsoft_student_developer_blog" title="Blog">Blog</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://msdn.microsoft.com/students-develop-msdn" title="Develop Apps">Develop Apps</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="Architects">Architects</a>

                                                <ul class="navL3" style="display: none;">
                                                        <li class="inactive">
                                                            <a href="http://msdn.microsoft.com/architects-overview-msdn" title="Overview">Overview</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://msdn.microsoft.com/architects-case-studies-msdn" title="Case studies">Case studies</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://msdn.microsoft.com/architects-blueprints-msdn" title="Blueprints">Blueprints</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://blogs.msdn.com/b/msarchitecture/" title="Blog">Blog</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://social.msdn.microsoft.com/forums/en-us/home?brandignore=true&sort=relevancedesc&searchterm=architecture+or+architect" title="Forums">Forums</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://events.msdn.microsoft.com/" title="Events">Events</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)" title="Community">Community</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive">
                                            <a href="https://social.msdn.microsoft.com/forums/" title="Forums">Forums</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://blogs.msdn.com/b/developer-tools/" title="Blogs">Blogs</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://tech-advisors.msdn.microsoft.com/en-us" title="Tech Advisors">Tech Advisors</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://channel9.msdn.com/" title="Channel 9">Channel 9</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive current toggle">
                            <a href="javascript:void(0)" title="Documentation">Documentation</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive current">
                                            <a href="http://msdn.microsoft.com/library/" title="APIs and reference">APIs and reference</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://msdn.microsoft.com/developer-centers-msdn" title="Dev centers">Dev centers</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive">
                            <a href="https://code.msdn.microsoft.com/" title="Samples">Samples</a>
                        </li>
            </ul>
        </nav>
                
                </div>
                <div class="right mobile"></div>
                
                <span id="singleCol"></span>
                <span id="doubleCol"></span>
             </div>
        </header>
    </div>
    
    

        
    <div class="printExportMenus ltr">
        <a id="isd_printABook" href="http://msdn.microsoft.com/en-us/library/export/help/?returnUrl=%2fen-us%2flibrary%2fms997538.aspx" style="display: inline;">
            Export (<span class="count">0</span>)
        </a>
        <a id="isd_print" href="http://msdn.microsoft.com/en-us/library/ms997538(d=printer).aspx" rel="nofollow">
            Print 
        </a>
    </div>
    

        <div class="printExportMenus ltr">
        <a id="expandCollapseAll" accesskey="e" href="javascript:void(0)" title="Expand/Collapse all sections by pressing Ctrl + Shift + e" style="display: none;">Expand All</a>
    </div>

    


            <div id="body">
                








    <div id="leftNav" style="width: 280px; max-width: 480px; min-height: 7604px; height: 729px;">



<div id="tocnav" style="width: 280px; position: fixed; top: 60px;">

            <div class="toclevel0" data-toclevel="0" style="padding-left: 0px;">
<a class="toc_collapsed" href="http://msdn.microsoft.com/en-us/library/ms997538.aspx#"></a><a data-tochassubtree="true" href="http://msdn.microsoft.com/en-us/library/ms123401.aspx" id="ms310241_MSDN.10_en-us" mtpsaliasid="" mtpsassetid="5DDC0A78-6B2C-43E3-9C56-55F45C0DFFA5_MSDN.10_en-us" mtpsshortid="ms123401_MSDN.10_en-us" title="MSDN Library">MSDN Library</a>            </div>
            <div class="toclevel0" data-toclevel="0" style="padding-left: 0px;">
<a class="toc_collapsed" href="http://msdn.microsoft.com/en-us/library/ms997538.aspx#"></a><a data-tochassubtree="true" href="http://msdn.microsoft.com/en-us/library/ee663300(v=vs.85).aspx" id="aa139672_MSDN.10_en-us" mtpsaliasid="" mtpsassetid="f61a75b8-8745-4146-8d76-d68614d838b4_MSDN.10_en-us" mtpsshortid="ee663300_VS.85_en-us" title="Windows Desktop App Development">Windows Desktop App Development</a>            </div>
            <div class="toclevel0" data-toclevel="0" style="padding-left: 0px;">
<a class="toc_collapsed" href="http://msdn.microsoft.com/en-us/library/ms997538.aspx#"></a><a data-tochassubtree="true" href="http://msdn.microsoft.com/en-us/library/hh529126(v=vs.85).aspx" id="hh309535_VS.85_en-us" mtpsaliasid="" mtpsassetid="FEDA4A1A-31F9-4B1E-9083-FB047281CCC7_VS.85_en-us" mtpsshortid="hh529126_VS.85_en-us" title="Archive">Archive</a>            </div>
            <div class="toclevel0" data-toclevel="0" style="padding-left: 0px;">
<a class="toc_collapsed" href="http://msdn.microsoft.com/en-us/library/ms997538.aspx#"></a><a data-tochassubtree="true" href="http://msdn.microsoft.com/en-us/library/hh703249(v=vs.85).aspx" id="hh309536_VS.85_en-us" mtpsaliasid="" mtpsassetid="0A801CD6-2618-4E15-AB67-52D82EB42728_VS.85_en-us" mtpsshortid="hh703249_VS.85_en-us" title="App UI">App UI</a>            </div>
            <div class="toclevel1" data-toclevel="1" data-childrenloaded="true" style="padding-left: 17px;">
<a class="toc_expanded" href="http://msdn.microsoft.com/en-us/library/ms997538.aspx#"></a><a data-tochassubtree="true" href="http://msdn.microsoft.com/en-us/library/ff802694.aspx" id="ff802694_MSDN.10_en-us" mtpsaliasid="" mtpsassetid="MSDN|dnwui|$\dnwui.hxt@0,0_MSDN.10_en-us" mtpsshortid="ff802694_MSDN.10_en-us" title="User Interface">User Interface</a>            </div>
            <div class="toclevel2" data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="http://msdn.microsoft.com/en-us/library/ms997569.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="A Virtual List Box Implementation with VLIST">A Virtual List Box Implementation with VLIST</a>            </div>
            <div class="toclevel2" data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="http://msdn.microsoft.com/en-us/library/ms997498.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Best Practices for Supporting Microsoft Mouse and Keyboard Devices">Best Practices for Supporting Microsoft Mouse and Keyboard Devices</a>            </div>
            <div class="toclevel2" data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="http://msdn.microsoft.com/en-us/library/ms997504.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="But Can They Hear It?">But Can They Hear It?</a>            </div>
            <div class="toclevel2" data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="http://msdn.microsoft.com/en-us/library/ms997553.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Converting Large Dialogs into Property Sheets">Converting Large Dialogs into Property Sheets</a>            </div>
            <div class="toclevel2" data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="http://msdn.microsoft.com/en-us/library/ms997573.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Creating Shell Extensions with Shell Instance Objects">Creating Shell Extensions with Shell Instance Objects</a>            </div>
            <div class="toclevel2" data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="http://msdn.microsoft.com/en-us/library/ms997530.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Edit Controls">Edit Controls</a>            </div>
            <div class="toclevel2 current" data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="./Icons_files/Icons.html" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Icons">Icons</a>            </div>
            <div class="toclevel2" data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="http://msdn.microsoft.com/en-us/library/ms997507.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Layered Windows">Layered Windows</a>            </div>
            <div class="toclevel2" data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="http://msdn.microsoft.com/en-us/library/ms997541.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="List Box Controls">List Box Controls</a>            </div>
            <div class="toclevel2" data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="http://msdn.microsoft.com/en-us/library/ms997557.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Scroll Bar Controls">Scroll Bar Controls</a>            </div>
            <div class="toclevel2" data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="http://msdn.microsoft.com/en-us/library/ms997500.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="The Shell Drag/Drop Helper Object Part 1: IDropTargetHelper">The Shell Drag/Drop Helper Object Part 1: IDropTargetHelper</a>            </div>
            <div class="toclevel2" data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="http://msdn.microsoft.com/en-us/library/ms997502.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="The Shell Drag/Drop Helper Object Part 2: IDropSourceHelper">The Shell Drag/Drop Helper Object Part 2: IDropSourceHelper</a>            </div>
            <div class="toclevel2" data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="http://msdn.microsoft.com/en-us/library/ms997560.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Static Controls">Static Controls</a>            </div>
            <div class="toclevel2" data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="http://msdn.microsoft.com/en-us/library/ms997518.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Supporting the Clipboard, DDE, and OLE in Applications">Supporting the Clipboard, DDE, and OLE in Applications</a>            </div>
            <div class="toclevel2" data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="http://msdn.microsoft.com/en-us/library/ms997524.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Supporting the DDE System Topic">Supporting the DDE System Topic</a>            </div>
            <div class="toclevel2" data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="http://msdn.microsoft.com/en-us/library/ms997549.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="The Rebar Control: Using a Coolbar in Your Application">The Rebar Control: Using a Coolbar in Your Application</a>            </div>
</div>
        

        

        
        
        <div id="toc-resizable-ew" class="toc-resizable-ew"></div>
        

<a id="NavigationResize" href="javascript:void(0)" style="left: 280px; display: inline-block;">
    <img class="cl_nav_resize_open" src="./Icons_files/ImageSprite.png" title="Expand" alt="Expand">
    <img class="cl_nav_resize_close" src="./Icons_files/ImageSprite.png" title="Minimize" alt="Minimize" style="display: none;">
</a>



    </div>
<div id="content" class="content" style="margin-left: 280px; width: auto;">





    
    <div id="FeedbackCounterUrl" data-url="/en-us/library/feedbackcounterasync/ms997538.aspx"></div>
    <div id="FeedbackCounterPlaceHolder"><link rel="stylesheet" type="text/css" href="./Icons_files/FeedbackCounter.css" xmlns="http://www.w3.org/1999/xhtml">
    
    

    <div id="ratingCounterSeperator" class="cl_lw_vs_seperator" style="display: none;" xmlns="http://www.w3.org/1999/xhtml"></div>

    
</div>


        

<div class="topic" xmlns="http://www.w3.org/1999/xhtml">
  <h1 class="title">Icons</h1><div id="ratingCounter" xmlns="http://www.w3.org/1999/xhtml" style="display: block;">
        <span id="rcA" class="ratingText">
            82 out of 117 rated this helpful <span id="rateThisPrefix">- </span><a id="rateThisTopic" href="http://msdn.microsoft.com/en-us/library/ms997538.aspx#feedback" title="Rate this topic">Rate this topic</a>
            
        </span>
    </div>
  
  <a id="msdn_icons">
    
  </a>


<div id="nstext">&nbsp;
<p>John Hornick <br>
Microsoft Corporation</p>

<p>Created: September 29, 1995</p>

<br>
<p>Download <a href="http://download.microsoft.com/download/win95/Utility/1.0/W9XXP/EN-US/4493.exe">4493.exe</a>.</p>

<h2 class="dtH1">Abstract</h2>

<p>This article describes, in detail, the format and use of icons in Windows. The following topics are covered; the format of icon resources in ICO, DLL and EXE files, the format of icon images in memory, Windows' use of icons, Windows' selection of an icon image from an icon resource, and the API provided to manipulate icon images. To follow the discussion, the reader should be familiar with Device Independent Bitmaps (DIBs) and their format. For more information about DIBs, please refer to the following sources:

</p><ul>
	<li>Documentation for the BITMAPINFO structure</li>

	<li>Knowledge Base article Q81498 SAMPLE: DIBs and Their Uses</li>

	<li>Knowledge Base article Q94326 SAMPLE: 16 and 32 Bits-Per-Pel Bitmap Formats</li>
</ul>

<p>Sample code dealing with some of the topics in this article is available in the Platform SDK sample tree in the IconPro project.</p>

<blockquote class="dtBlock"><div>
<strong>Disclaimer</strong><div class="tt">&nbsp;&nbsp;&nbsp;</div>Internal details discussed in this article are subject to change without notice in future versions of Windows.</div></blockquote>

<h2 class="dtH1">Introduction</h2>

<p>Icons are a varied lot—they come in many sizes and color depths. A single icon resource—an ICO file, or an icon resource in an EXE or DLL file—can contain multiple icon images, each with a different size and/or color depth. Windows 95 and future versions of Windows NT (collectively referred to as "Windows" from here on) extract the appropriate size/color depth image from the resource depending on the context of the icon's use. Windows also provides a collection of functions for accessing and displaying icons and icon images.</p>

<h2 class="dtH1">What's in an Icon?</h2>

<p>An icon resource can contain multiple icon images. For example, one icon resource—in this case, a single .ICO file—can contain images in several sizes and color depths:</p>
<div class="tablediv"><table class="dtTABLE">

<tbody><tr><td>
<p class="fig"><code><img id="icons_1" alt="ms997538.icons_1(en-us,MSDN.10).gif" src="./Icons_files/IC19765.gif" title="ms997538.icons_1(en-us,MSDN.10).gif" xmlns=""></code></p>
</td><td>
<p class="fig"><code><img id="icons_2" alt="ms997538.icons_2(en-us,MSDN.10).gif" src="./Icons_files/IC43215.gif" title="ms997538.icons_2(en-us,MSDN.10).gif" xmlns=""></code></p>
</td><td class="fig"><code><img id="icons_3" alt="ms997538.icons_3(en-us,MSDN.10).gif" src="./Icons_files/IC33777.gif" title="ms997538.icons_3(en-us,MSDN.10).gif" xmlns=""></code></td></tr>

<tr><td>16 x 16&nbsp;&nbsp;16 colors</td><td>32 x 32&nbsp;&nbsp;16 colors</td><td>72 x 72&nbsp;&nbsp;256 colors</td></tr>
</tbody></table></div>

<h3 class="dtH1">The ICO File</h3>

<p>An Icon file, which usually has the ICO extension, contains one icon resource. Given that an icon resource can contain multiple images, it is no surprise that the file begins with an icon directory:</p>


<div id="code-snippet-1" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_9d7c78ce-c34f-45bf-a31d-b59fc4e526e3');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_9d7c78ce-c34f-45bf-a31d-b59fc4e526e3" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>typedef struct
{
    WORD           idReserved;   // Reserved (must be 0)
    WORD           idType;       // Resource Type (1 for icons)
    WORD           idCount;      // How many images?
    ICONDIRENTRY   idEntries[1]; // An entry for each image (idCount of 'em)
} ICONDIR, *LPICONDIR;

</pre></div>
            
        </div>
    </div>
</div>


<p>The <strong>idCount</strong> member indicates how many images are present in the icon resource. The size of the <strong>idEntries</strong> array is determined by <strong>idCount</strong>. There exists one ICONDIRENTRY for each icon image in the file, providing details about its location in the file, size and color depth. The ICONDIRENTRY structure is defined as:</p>


<div id="code-snippet-2" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_448b0afb-a7cb-40a5-9384-14a620a5a2c8');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_448b0afb-a7cb-40a5-9384-14a620a5a2c8" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>typedef struct
{
    BYTE        bWidth;          // Width, in pixels, of the image
    BYTE        bHeight;         // Height, in pixels, of the image
    BYTE        bColorCount;     // Number of colors in image (0 if &gt;=8bpp)
    BYTE        bReserved;       // Reserved ( must be 0)
    WORD        wPlanes;         // Color Planes
    WORD        wBitCount;       // Bits per pixel
    DWORD       dwBytesInRes;    // How many bytes in this resource?
    DWORD       dwImageOffset;   // Where in the file is this image?
} ICONDIRENTRY, *LPICONDIRENTRY;

</pre></div>
            
        </div>
    </div>
</div>


<p>For each ICONDIRENTRY, the file contains an icon image. The <strong>dwBytesInRes</strong> member indicates the size of the image data. This image data can be found <strong>dwImageOffset</strong> bytes from the beginning of the file, and is stored in the following format:</p>


<div id="code-snippet-3" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_02eb7dc3-de9e-49b8-938a-53b2b9e7cd82');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_02eb7dc3-de9e-49b8-938a-53b2b9e7cd82" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>typdef struct
{
   BITMAPINFOHEADER   icHeader;      // DIB header
   RGBQUAD         icColors[1];   // Color table
   BYTE            icXOR[1];      // DIB bits for XOR mask
   BYTE            icAND[1];      // DIB bits for AND mask
} ICONIMAGE, *LPICONIMAGE;

</pre></div>
            
        </div>
    </div>
</div>


<p>The <strong>icHeader</strong> member has the form of a DIB BITMAPINFOHEADER. Only the following members are used: <strong>biSize</strong>, <strong>biWidth</strong>, <strong>biHeight</strong>, <strong>biPlanes</strong>, <strong>biBitCount</strong>, <strong>biSizeImage</strong>. All other members must be 0. The <strong>biHeight</strong> member specifies the combined height of the XOR and AND masks. The members of <strong>icHeader</strong> define the contents and sizes of the other elements of the ICONIMAGE structure in the same way that the BITMAPINFOHEADER structure defines a CF_DIB format DIB.</p>

<p>The <strong>icColors</strong> member is an array of RGBQUADs. The number of elements in this array is determined by examining the <strong>icHeader</strong> member.</p>

<p>The <strong>icXOR</strong> member contains the DIB bits for the XOR mask of the image. The number of bytes in this array is determined by examining the <strong>icHeader</strong> member. The XOR mask is the color portion of the image and is applied to the destination using the XOR operation after the application of the AND mask.</p>

<p>The icAND member contains the bits for the monochrome AND mask. The number of bytes in this array is determined by examining the icHeader member, and assuming 1bpp. The dimensions of this bitmap must be the same as the dimensions of the XOR mask. The AND mask is applied to the destination using the AND operation, to preserve or remove destination pixels before applying the XOR mask.</p>

<blockquote class="dtBlock"><div>
<strong>Note</strong><div class="tt">&nbsp;&nbsp;&nbsp;</div>The <strong>biHeight</strong> member of the <strong>icHeader</strong> structure represents the combined height of the XOR and AND masks. Remember to divide this number by two before using it to perform calculations for either of the XOR or AND masks. Also remember that the AND mask is a monochrome DIB, with a color depth of 1 bpp.</div></blockquote>

<p>The following is an incomplete code fragment for reading an .ICO file:</p>


<div id="code-snippet-4" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_7328862c-89ef-48ee-8f56-8a2d65a7550b');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_7328862c-89ef-48ee-8f56-8a2d65a7550b" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>// We need an ICONDIR to hold the data
pIconDir = malloc( sizeof( ICONDIR ) );
// Read the Reserved word
ReadFile( hFile, &amp;(pIconDir-&gt;idReserved), sizeof( WORD ), &amp;dwBytesRead, NULL );
// Read the Type word - make sure it is 1 for icons
ReadFile( hFile, &amp;(pIconDir-&gt;idType), sizeof( WORD ), &amp;dwBytesRead, NULL );
// Read the count - how many images in this file?
ReadFile( hFile, &amp;(pIconDir-&gt;idCount), sizeof( WORD ), &amp;dwBytesRead, NULL );
// Reallocate IconDir so that idEntries has enough room for idCount elements
pIconDir = realloc( pIconDir, ( sizeof( WORD ) * 3 ) +
                              ( sizeof( ICONDIRENTRY ) * pIconDir-&gt;idCount ) );
// Read the ICONDIRENTRY elements
ReadFile( hFile, pIconDir-&gt;idEntries, pIconDir-&gt;idCount * sizeof(ICONDIRENTRY),
          &amp;dwBytesRead, NULL );
// Loop through and read in each image
for(i=0;i&lt;pIconDir-&gt;idCount;i++)
{
  // Allocate memory to hold the image
  pIconImage = malloc( pIconDir-&gt;idEntries[i].dwBytesInRes );
  // Seek to the location in the file that has the image
  SetFilePointer( hFile, pIconDir-&gt;idEntries[i].dwImageOffset, 
                  NULL, FILE_BEGIN );
  // Read the image data
  ReadFile( hFile, pIconImage, pIconDir-&gt;idEntries[i].dwBytesInRes,
            &amp;dwBytesRead, NULL );
  // Here, pIconImage is an ICONIMAGE structure. Party on it :)
  // Then, free the associated memory
  free( pIconImage );
}
// Clean up the ICONDIR memory
free( pIconDir );

</pre></div>
            
        </div>
    </div>
</div>


<p>Complete code can be found in the Icons.C module of IconPro, in a function named <strong>ReadIconFromICOFile</strong>.</p>

<h3 class="dtH1">DLL and EXE Files</h3>

<p>Icons can also be stored in .DLL and .EXE files. The structures used to store icon images in .EXE and .DLL files differ only slightly from those used in .ICO files.</p>

<p>Analogous to the ICONDIR data in the ICO file is the RT_GROUP_ICON resource. In fact, one RT_GROUP_ICON resource is created for each ICO file bound to the EXE or DLL with the resource compiler/linker. The RT_GROUP_ICON resource is simply a GRPICONDIR structure:</p>


<div id="code-snippet-5" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_4cdc6089-32d6-41e9-9555-d0bf8542bf56');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_4cdc6089-32d6-41e9-9555-d0bf8542bf56" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>// #pragmas are used here to insure that the structure's
// packing in memory matches the packing of the EXE or DLL.
#pragma pack( push )
#pragma pack( 2 )
typedef struct 
{
   WORD            idReserved;   // Reserved (must be 0)
   WORD            idType;       // Resource type (1 for icons)
   WORD            idCount;      // How many images?
   GRPICONDIRENTRY   idEntries[1]; // The entries for each image
} GRPICONDIR, *LPGRPICONDIR;
#pragma pack( pop )

</pre></div>
            
        </div>
    </div>
</div>


<p>The <strong>idCount</strong> member indicates how many images are present in the icon resource. The size of the <strong>idEntries</strong> array is determined by <strong>idCount</strong>. There exists one GRPICONDIRENTRY for each icon image in the resource, providing details about its size and color depth. The GRPICONDIRENTRY structure is defined as:</p>


<div id="code-snippet-6" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_b90858ba-77a9-4b7f-888e-321cc67b6789');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_b90858ba-77a9-4b7f-888e-321cc67b6789" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>#pragma pack( push )
#pragma pack( 2 )
typedef struct
{
   BYTE   bWidth;               // Width, in pixels, of the image
   BYTE   bHeight;              // Height, in pixels, of the image
   BYTE   bColorCount;          // Number of colors in image (0 if &gt;=8bpp)
   BYTE   bReserved;            // Reserved
   WORD   wPlanes;              // Color Planes
   WORD   wBitCount;            // Bits per pixel
   DWORD   dwBytesInRes;         // how many bytes in this resource?
   WORD   nID;                  // the ID
} GRPICONDIRENTRY, *LPGRPICONDIRENTRY;
#pragma pack( pop )

</pre></div>
            
        </div>
    </div>
</div>


<p>The <strong>dwBytesInRes</strong> member indicates the total size of the RT_ICON resource referenced by the <strong>nID</strong> member. <strong>nID</strong> is the RT_ICON identifier that can be passed to <strong>FindResource</strong>, <strong>LoadResource</strong> and <strong>LockResource</strong> to obtain a pointer to the ICONIMAGE structure (defined above) for this image.</p>

<p>The following is an incomplete code fragment for reading icons from a .DLL or .EXE file:</p>


<div id="code-snippet-7" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_7c4d9f3c-8cbb-4f0c-9554-95bee4b46a33');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_7c4d9f3c-8cbb-4f0c-9554-95bee4b46a33" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>// Load the DLL/EXE without executing its code
hLib = LoadLibraryEx( szFileName, NULL, LOAD_LIBRARY_AS_DATAFILE );
// Find the group resource which lists its images
hRsrc = FindResource( hLib, MAKEINTRESOURCE( nId ), RT_GROUP_ICON );
// Load and Lock to get a pointer to a GRPICONDIR
hGlobal = LoadResource( hLib, hRsrc );
lpGrpIconDir = LockResource( hGlobal );
// Using an ID from the group, Find, Load and Lock the RT_ICON
hRsrc = FindResource( hLib, MAKEINTRESOURCE( lpGrpIconDir-&gt;idEntries[0].nID ),
                      RT_ICON );
hGlobal = LoadResource( hLib, hRsrc );
lpIconImage = LockResource( hGlobal );
// Here, lpIconImage points to an ICONIMAGE structure

</pre></div>
            
        </div>
    </div>
</div>


<p>Complete code can be found in the Icons.C module of IconPro, in a function named <strong>ReadIconFromEXEFile</strong>.</p>

<h3 class="dtH1">In Memory</h3>

<p>When dealing with icon resources in memory, the format is identical to the format used in .EXE and .DLL files. Functions such as <strong>CreateIconFromResource</strong> expect to be passed an ICONIMAGE structure. This is very convenient since <strong>FindResource</strong>, <strong>LoadResource</strong> and <strong>LockResource </strong>can be used to load the RT_ICON resource in that format.</p>

<p>An HICON handle is a handle to a single icon image, or RT_ICON resource. In previous versions of Windows, the size of an HICON image could be determined by calling <strong>GetSystemMetrics</strong> with the SM_CYICON and SM_CXICON flags. It is now possible, however, to have HICON handles for icons with non-standard sizes. HICON icons always have the same color format as the display device. See the discussion of functions below for more details on how to handle icons of different sizes and color depths using HICON handles.</p>

<h2 class="dtH1">When in Windows</h2>

<p>In Windows, the system maintains the concept of  two sizes of icons, small and large. Further, the shell also has a concept of small and large icons. This means that in total, Windows is aware of four different icon sizes—System Small, System Large, Shell Small, and Shell Large.</p>

<p>The System Small size is derived from the size of window captions. The caption size can be adjusted from the "Appearance" tab in the Display Properties dialog. Adjustments made to the caption size are immediately reflected in the System Small icon size. The System Small size can be queried by calling <strong>GetSystemMetrics</strong> with the SM_CXSMICON and SM_CYSMICON parameters.</p>

<p>The System Large size is defined by the video driver and therefore cannot be changed dynamically. The System Large size can be queried by calling <strong>GetSystemMetrics</strong> with the SM_CXICON and SM_CYICON parameters.</p>

<p>The Shell Small size is defined by Windows, and currently Windows does not support changing this value, nor is there currently a direct way to query this value. </p>

<p>The Shell Large size is stored in the registry under the following key:</p>


<div id="code-snippet-8" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_77dc6e25-a97e-4274-acad-427b74bd4b61');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_77dc6e25-a97e-4274-acad-427b74bd4b61" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>HKEY_CURRENT_USER\Control Panel\desktop\WindowMetrics\Shell Icon Size

</pre></div>
            
        </div>
    </div>
</div>


<p>The Shell Large size can be changed by modifying the registry or from the "Appearance" tab in the Display Properties dialog, which allows values from 16 to 72. Following is an example of code that can be used to change the Shell Large icon size by accessing the registry:</p>


<div id="code-snippet-9" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_4559ff24-f08b-42d9-9397-411a4edfe7ca');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_4559ff24-f08b-42d9-9397-411a4edfe7ca" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>DWORD SetShellLargeIconSize( DWORD dwNewSize )
{
   #define MAX_LENGTH   512
   DWORD   dwOldSize, dwLength = MAX_LENGTH, dwType = REG_SZ;
   TCHAR   szBuffer[MAX_LENGTH];
   HKEY   hKey;

   // Get the Key
   RegOpenKey( HKEY_CURRENT_USER, "Control Panel\\desktop\\WindowMetrics",                   &amp;hKey);
   // Save the last size
   RegQueryValueEx( hKey, "Shell Icon Size", NULL, &amp;dwType, szBuffer, 
               &amp;dwLength );
   dwOldSize = atol( szBuffer );
   // We will allow only values &gt;=16 and &lt;=72
   if( (dwNewSize&gt;=16) || (dwNewSize&lt;=72) )
   {
      wsprintf( szBuffer, "%d", dwNewSize );
      RegSetValueEx( hKey, "Shell Icon Size", 0, REG_SZ, szBuffer,
                  lstrlen(szBuffer) + 1 );
   }
   // Clean up
   RegCloseKey( hKey );
   // Let everyone know that things changed
   SendMessage( HWND_BROADCAST, WM_SETTINGCHANGE, SPI_SETICONMETRICS,
               (LPARAM)("WindowMetrics") );
   return dwOldSize;
   #undef MAX_LENGTH
}

</pre></div>
            
        </div>
    </div>
</div>


<p class="label"><strong>Table 1. Where Windows Uses Different Sized Icons</strong></p>
<div class="tablediv"><table class="dtTABLE">

<tbody><tr><th>Location</th><th>Icon Size</th></tr>

<tr><td>Desktop</td><td>Shell Large</td></tr>

<tr><td>TitleBar of Windows</td><td>System Small</td></tr>

<tr><td>&lt;Alt&gt;&lt;Tab&gt; Dialog</td><td>System Large</td></tr>

<tr><td>Start Menu</td><td>Shell Small / Shell Large</td></tr>
</tbody></table></div>

<p>While Windows imposes no restrictions on the sizes of icons, common sizes include 16, 32, and 48 pixels square. For this reason, developers are encouraged to include a minimum of the following sizes and color depths in their icon resources:</p>
<div class="tablediv"><table class="dtTABLE">

<tbody><tr><td>16 x 16</td><td>16 colors</td></tr>

<tr><td>32 x 32</td><td>16 colors</td></tr>

<tr><td>48 x 48</td><td>256 colors</td></tr>
</tbody></table></div>

<h3 class="dtH1">Choosing an Icon</h3>

<p>When Windows prepares to display an icon, a desktop shortcut for example, it must parse the .EXE or .DLL file and extract the appropriate icon image. This selection is a two step process starting with the selection of the appropriate RT_GROUP_ICON resource, and ending with the selection of the proper RT_ICON image from that RT_GROUP_ICON.</p>

<h4 class="dtH1">Which Icon?</h4>

<p>If an .EXE or .DLL file has only one RT_GROUP_ICON resource, the first step is trivial; Windows simply uses that resource. However, if more than one such group resource exists in the file, Windows must decide which one to use. Windows NT simply chooses the first resource listed in the application's RC script. On the other hand, Windows 95's algorithm is to choose the alphabetically first named group icon if one exists. If one such group resource does not exist, Windows chooses the icon with the numerically lowest identifier. So, to be sure that a particular icon is used for an application, the developer should insure that both of the following criteria are met:

</p><ol>
	<li>The icon is placed before all other icons in the RC file.</li>

	<li>If the icon is named, its name is alphabetically before any other named icon, otherwise its resource identifier is numerically smaller than any other icon.</li>
</ol>

<h4 class="dtH1">Which Image?</h4>

<p>Once an RT_GROUP_ICON is chosen, the individual icon image, or RT_ICON resource, must be selected and extracted. Again, if there exists only one RT_ICON resource for the group in question, the choice is trivial. However, if multiple images are present in the group, the following selection rules are applied:

</p><ol>
	<li>The image closest in size to the requested size is chosen.</li>

	<li>If two or more images of that size are present, the one that matches the color depth of the display is chosen.</li>

	<li>If none exactly match the color depth of the display, Windows chooses the image with the greatest color depth without exceeding the color depth of the display.</li>

	<li>If all the size-matched images exceed the color depth of the display, the one with the lowest color depth is chosen.</li>

	<li>Windows treats all color depths of 8 or more bpp as equal. For example, it is pointless to have a 16x16 256 color image and a 16x16 16bpp image in the same resource—Windows will simply choose the first one it encounters. </li>

	<li>When the display is in 8bpp mode, Windows will prefer a 16 color icon over a 256 color icon, and will display all icons using the system default palette.</li>
</ol>

<h2 class="dtH1">The Icon API</h2>

<p>When dealing with icons, the developer can choose to manipulate the raw resource bytes, or let Windows handle the low level details and simply use HICON handles. The advantage of handling the raw resource bytes is a gain in control, while the advantage of using the HICON handles is that of simplicity. For most purposes, the HICON interface is sufficient—it is likely that handling the raw resource bytes will be necessary only in the development of an icon handling program.</p>

<h3 class="dtH1">Raw Resource Bytes</h3>

<p>The standard Windows API functions for manipulating resources—<strong>FindResource</strong>, <strong>LoadResource</strong> and <strong>LockResource</strong>—can, of course, be used to handle icon resources.</p>

<p><strong>EnumResourceNames</strong> can be used, passing in RT_GROUP_ICON, to find the available group icon resources. Once the appropriate group resource is chosen, it can be loaded using <strong>FindResource</strong>, <strong>LoadResource</strong> and <strong>LockResource</strong>. This will yield a pointer to a GRPICONDIR structure.</p>

<p>The <strong>idEntries</strong> array is the searched for a match on the desired color depth and size. The <strong>nID</strong> member of that array element is then used as an argument to <strong>FindResource</strong>, passing in RT_ICON. <strong>LoadResource</strong> and <strong>LockResource</strong> then yield a pointer to an ICONIMAGE structure for that icon image.</p>

<p>To allow Windows to perform the color depth and size selection, the GRPICONDIR structure can be passed to <strong>LookUpIconIdFromDirectory</strong> or L<strong>ookUpIconIdFromDirectoryEx</strong>. Both of these functions return an id that can be used with RT_ICON and FindResource, the latter providing a way to specify a desired size to match against. </p>

<p>The ICONIMAGE structure contains pointers to the DIB bits for the masks. These pointers can be used in DIB functions for direct manipulation. The ICONIMAGE structure is also conveniently suitable to be passed to <strong>CreateIconFromResource</strong> or <strong>CreateIconFromResourceEx</strong> to yield an HICON handle. The former of the two functions creates an icon that is System Large size. The latter provides a way to specify a desired size, and Windows performs the appropriate conversions. </p>

<h3 class="dtH1">HICON Handles</h3>

<p>An HICON handle is a handle to a single icon image. This is analogous to a single RT_ICON resource. The image is stored internally using device dependent bitmaps (DDBs). This implies that all HICON icons have the same color format as the display device. The size of the icon depends on its origin and the system defined icon sizes.</p>

<p>The available icon handling functions can be thought of in two groups—those that handle System Large size icons and those that handle any size icons. The functions that handle only System Large size icons are typically left over from 16 bit days, when the system defined only one icon size. The newer functions, those that handle any size icon, accept as a parameter the desired size of the icon.</p>

<h4 class="dtH1">One Size Fits All</h4>

<p>The original icon handling functions were designed for a system that defined only one icon size. Therefore, most of those functions are unaware of the possibility of more than one icon size and assume all icons are System Large size.</p>

<p><strong>LoadIcon</strong>, <strong>ExtractIcon</strong> and <strong>DrawIcon</strong> fall into this category. <strong>LoadIcon</strong> and <strong>ExtractIcon</strong> always search for a match for System Large size. If an exact match cannot be found, these two functions stretch the closest match to that size. They always return an icon of System Large size. Similarly, <strong>DrawIcon</strong> always draws the icon at System Large size. If a different size icon is passed to <strong>DrawIcon</strong>, it is stretched and displayed at System Large size.</p>

<p><strong>CreateIconFromResource</strong> also exhibits this behavior. It returns a handle to a System Large size icon, stretching the RT_ICON resource it was passed as necessary.</p>

<h4 class="dtH1">To Each Their Own</h4>

<p>Now that Windows has the ability to handle different sized icons, new functions were added to handle them. In some cases, old functions were expanded and "Ex" was added to their name. In other cases, whole new functions were added. The net result is that there is now full support for different sized icons in the Windows API.</p>

<p>Several different functions are available to get an HICON handle to a different sized icon. <strong>LoadImage</strong> can be used to extract an icon from an EXE or DLL file without the hassle of manually loading the resource bytes. <strong>CreateIconFromResourceEx</strong> is available if the resource bytes have been loaded.</p>

<p><strong>CreateIcon</strong> and <strong>CreateIconIndirect</strong>, even though they have their roots in 16-bit land, do facilitate creating icons of different sizes. <strong>CreateIcon</strong> accept a desired width and height as parameters, while <strong>CreateIconIndirect</strong> creates an icon based on the bitmaps in the ICONINFO parameter. Note that both of these functions work with DDBs, not DIBs.</p>

<p><strong>SHGetFileInfo</strong> can also be used to get icons from files, providing the icon that the shell would display for the file. <strong>SHGetFileInfo</strong> works on any type of file, and can extract any of the four icons sizes, as shown below:</p>


<div id="code-snippet-10" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_6e6a25e3-3107-462c-bbaf-f1454567b16a');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_6e6a25e3-3107-462c-bbaf-f1454567b16a" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>// Load a System Large icon image
SHGetFileInfo( szFileName, 0, &amp;shfi, sizeof( SHFILEINFO ), 
               SHGFI_ICON | SHGFI_LARGEICON);

// Load a System Small icon image
SHGetFileInfo( szFileName, 0, &amp;shfi, sizeof( SHFILEINFO ), 
               SHGFI_ICON | SHGFI_SMALLICON);

// Load a Shell Large icon image
SHGetFileInfo( szFileName, 0, &amp;shfi, sizeof( SHFILEINFO ), 
               SHGFI_ICON | SHGFI_SHELLICONSIZE);

// Load a Shell Small icon image
SHGetFileInfo( szFileName, 0, &amp;shfi, sizeof( SHFILEINFO ), 
               SHGFI_ICON | SHGFI_SHELLICONSIZE | SHGFI_SMALLICON);

</pre></div>
            
        </div>
    </div>
</div>


<p>Given an HICON handle, DrawIconEx can be used to display it—at its normal size, at the System Large size, or at any other size:</p>


<div id="code-snippet-11" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_21a5b153-4d52-4f56-a672-805a2f83ade5');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_21a5b153-4d52-4f56-a672-805a2f83ade5" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>// Draw it at its native size
DrawIconEx( hDC, nLeft, nTop, hIcon, 0, 0, 0, NULL, DI_NORMAL );

// Draw it at the System Large size
DrawIconEx( hDC, nLeft, nTop, hIcon, 0, 0, 0, 
            NULL, DI_DEFAULTSIZE | DI_NORMAL );

// Draw it at some other size (40x40 in this example)
DrawIconEx( hDC, nLeft, nTop, hIcon, 40, 40, 0, NULL, DI_NORMAL );

</pre></div>
            
        </div>
    </div>
</div>


<p>Note that DrawIconEx will stretch the icon as necessary to make it fit the desired output size.</p>

<h4 class="dtH1">What's in There?</h4>

<p>The Windows API provides a function for determining the characteristics of an icon, given its HICON handle. This function is <strong>GetIconInfo</strong>. <strong>GetIconInfo</strong> fills out an ICONINFO structure with the information pertaining to the HICON. The ICONINFO structure contains the following information:</p>


<div id="code-snippet-12" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_494116cc-1c7f-4122-aaf2-207834b97d37');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_494116cc-1c7f-4122-aaf2-207834b97d37" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>typedef struct _ICONINFO { // ii  

   BOOL    fIcon;   // TRUE for icon, FALSE for cursor
   DWORD   xHotspot;   // the x hotspot coordinate for cursor
   DWORD   yHotspot;   // the y hotspot coordinate for cursor
   HBITMAP hbmMask;   // handle to monochrome AND mask bitmap
   HBITMAP hbmColor;   // handle to device dependent XOR mask bitmap
} ICONINFO;

</pre></div>
            
        </div>
    </div>
</div>


<p>Given this information, an application can calculate the information needed to write the icon to a file. The AND mask and XOR mask DIB bits can be obtained with calls to <strong>GetDIBits</strong> on the two bitmaps in this structure.</p>

<h2 class="dtH1">A Word on Cursors</h2>

<p>Cursors are very similar to icons. In fact, by changing only one line in the source code for IconPro, that sample can read .CUR files. IconPro currently tests the <strong>idType</strong> member of the ICONDIR structure to make sure the file is an icon file. This check can be relaxed to allow the type for cursors (2) as well. Also, HCURSOR handles can be used interchangeably with HICON handles in most icon functions.</p>

<h2 class="dtH1">Conclusion</h2>

<p>Although the icon specification has long been able to handle icons of odd sizes and color depths, only recently has Windows responded with inherent support for such images. Developers now have the option of dealing directly with the bits of an icon, or allowing Windows to handle all the details. Windows even provides API support for loading and displaying icons of non-standard sizes and different color depths.</p>

 
</div> 

</div>

    




<div class="libraryMemberFilter">
    <div class="filterContainer">
        <span>Show:</span>
        <label>
            <input type="checkbox" class="libraryFilterInherited" checked="checked" value="Inherit">Inherited
        </label>
        <label>
            <input type="checkbox" class="libraryFilterProtected" checked="checked" value="Protected">Protected
        </label>
    </div>
</div>
    
<input type="hidden" id="libraryMemberFilterEmptyWarning" value="There are no members available with your current filter settings.">


 
</div>


            </div>
            <div class="clear"></div>

            
    
<input name="__RequestVerificationToken" type="hidden" value="T7lwAJIAuWFYkuqV2HNeZBicnskP_dkxy73GiOESZM48hsul6G2DQM79-0tO1p_Jn_pVUWoO3kS3Sd2y1gaFORwbn_pnJwlZKGY77JssQDMujLo80">
<input id="ratingSubmitUrl" type="hidden" value="http://msdn.microsoft.com/en-us/library/feedback/add/ms997538.aspx">
<input id="isTopicRated" type="hidden" value="false">




    

    
    <link type="text/css" rel="stylesheet">
    
    <div id="ux-footer" class="" style="" dir="ltr">
            
            <div id="footerSock" class="librarySock both">
                <div id="footerSockInner">
                        <a name="feedback"></a>

<div class="rating" style="display: block;">
    <div id="ratingSection1">
        <div class="title">
            Was this page helpful?
        </div>
        <div class="description">
            Your feedback about this content is important.<br>Let us know what you think.
        </div>
        <div class="buttons">
            <button class="button" id="ratingYes">Yes</button>
            <button class="button" id="ratingNo">No</button>
        </div>
        <input id="ratingValue" type="hidden" value="">
    </div>
    <div id="ratingSection2">
        <div class="title">
            Additional feedback?
        </div>
        <textarea id="ratingText" rows="6" cols="" maxlength="1500"></textarea>
        <div class="counter right">
            <span id="feedbackTextCounter">1500</span> characters remaining
        </div>
        <div class="buttons left">
            <button class="button" id="ratingSubmit">Submit</button>
            <button class="button" id="ratingSkipThis">Skip this</button>
        </div>
    </div>
    <div id="ratingSection3">
        <div class="title">
            Thank you!
        </div>
        <div class="description">
            We appreciate your feedback.
        </div>
    </div>
    
    
    <div id="contentFeedbackQAContainer" style="display: none;"></div>
</div>
    
                    <div class="userVoice">
    <div class="title">
        Have a suggestion to improve MSDN Library?
    </div>
        <div class="description">
            Visit our UserVoice Page to submit and vote on ideas!
        </div>
    <div class="buttons">
        <a class="button" id="userVoiceButton" href="http://feedback.msdn.com/forums/257782-msdn-feature-suggestions/category/83975" target="_blank">Make a suggestion</a>
    </div>
</div>  
                    <div class="clear"></div>
                </div>
            </div>

        <footer class="top">
            <div data-fragmentname="LeftLinks" id="Fragment_LeftLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">Dev centers</div>
    <ul class="links">
      <li>
        <a href="http://dev.windows.com/" id="LeftLinks_2148_1" class="windowsBlue" xmlns="http://www.w3.org/1999/xhtml">Windows</a>
      </li>
      <li>
        <a href="http://dev.office.com/" id="LeftLinks_2148_3" class="office" xmlns="http://www.w3.org/1999/xhtml">Office</a>
      </li>
      <li>
        <a href="http://msdn.microsoft.com/vstudio" id="LeftLinks_2148_4" class="visualStudio" xmlns="http://www.w3.org/1999/xhtml">Visual Studio</a>
      </li>
      <li>
        <a href="http://developer.nokia.com/" title="Nokia" id="LeftLinks_2148_15" class="nokia" xmlns="http://www.w3.org/1999/xhtml">Nokia</a>
      </li>
      <li>
        <a href="http://azure.microsoft.com/en-us/documentation/" target="_blank" id="LeftLinks_2148_12" xmlns="http://www.w3.org/1999/xhtml">Microsoft Azure</a>
      </li>
      <li>
        <a href="http://msdn.microsoft.com/aa937802" id="LeftLinks_2148_5" xmlns="http://www.w3.org/1999/xhtml">More...</a>
      </li>
    </ul>
  </div>
</div>    
            <div id="rightLinks">
                <div data-fragmentname="CenterLinks1" id="Fragment_CenterLinks1" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">Learning resources</div>
    <ul class="links">
      <li>
        <a href="http://www.microsoftvirtualacademy.com/" id="CenterLinks1_2151_4" xmlns="http://www.w3.org/1999/xhtml">Microsoft Virtual Academy</a>
      </li>
      <li>
        <a href="http://channel9.msdn.com/" id="CenterLinks1_2151_5" xmlns="http://www.w3.org/1999/xhtml">Channel 9</a>
      </li>
      <li>
        <a href="http://www.interoperabilitybridges.com/" id="CenterLinks1_2151_6" xmlns="http://www.w3.org/1999/xhtml">Interoperability Bridges</a>
      </li>
      <li>
        <a href="http://msdn.microsoft.com/magazine/" id="CenterLinks1_2151_7" xmlns="http://www.w3.org/1999/xhtml">MSDN Magazine</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks2" id="Fragment_CenterLinks2" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">Community</div>
    <ul class="links">
      <li>
        <a href="https://social.msdn.microsoft.com/forums/en-us/home" id="CenterLinks2_2151_8" xmlns="http://www.w3.org/1999/xhtml">Forums</a>
      </li>
      <li>
        <a href="http://blogs.msdn.com/b/developer-tools/" id="CenterLinks2_2151_9" xmlns="http://www.w3.org/1999/xhtml">Blogs</a>
      </li>
      <li>
        <a href="http://www.codeplex.com/" id="CenterLinks2_2151_10" xmlns="http://www.w3.org/1999/xhtml">Codeplex</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks3" id="Fragment_CenterLinks3" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">Support</div>
    <ul class="links">
      <li>
        <a href="http://msdn.microsoft.com/hh361695" id="CenterLinks3_2151_11" xmlns="http://www.w3.org/1999/xhtml">Self support</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks4" id="Fragment_CenterLinks4" xmlns="http://www.w3.org/1999/xhtml" class="nth-child-4n">
  
  <div class="linkList">
    <div class="linkListTitle">Programs</div>
    <ul class="links">
      <li>
        <a href="http://www.microsoft.com/bizspark/" id="CenterLinks4_2151_13" xmlns="http://www.w3.org/1999/xhtml">BizSpark (for startups)</a>
      </li>
      <li>
        <a href="https://www.dreamspark.com/" id="CenterLinks4_2151_14" xmlns="http://www.w3.org/1999/xhtml">DreamSpark</a>
      </li>
      <li>
        <a href="http://www.imaginecup.com/" id="CenterLinks4_2151_17" xmlns="http://www.w3.org/1999/xhtml">Imagine Cup</a>
      </li>
    </ul>
  </div>
</div>                
            </div>
        </footer>
    
        <footer class="bottom">
            <span class="localeContainer">
                
    <form class="selectLocale" id="selectLocaleForm" action="http://msdn.microsoft.com/en-us/selectlocale-dmc">
        <input type="hidden" name="fromPage" value="http%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fms997538.aspx">
        <a href="http://msdn.microsoft.com/en-us/library/ms997538.aspx#" onclick="$(&#39;#selectLocaleForm&#39;).submit();return false;" title="Change your language">United States (English)</a>
    </form>


            </span>
        
            <div data-fragmentname="BottomLinks" id="Fragment_BottomLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <ul class="links horizontal">
      <li>
        <a href="http://msdn.microsoft.com/newsletter.aspx" id="BottomLinks_2148_7" xmlns="http://www.w3.org/1999/xhtml">Newsletter</a>
      </li>
      <li>
        <a href="http://msdn.microsoft.com/dn529288" id="BottomLinks_2148_8" xmlns="http://www.w3.org/1999/xhtml">Privacy &amp; cookies</a>
      </li>
      <li>
        <a href="http://msdn.microsoft.com/cc300389" id="BottomLinks_2148_9" xmlns="http://www.w3.org/1999/xhtml">Terms of use</a>
      </li>
      <li>
        <a href="http://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" id="BottomLinks_2148_10" xmlns="http://www.w3.org/1999/xhtml">Trademarks</a>
      </li>
    </ul>
  </div>
</div>    
            <span class="logoLegal">
                <span class="logo"></span>
                <span class="copyright">© 2014 Microsoft</span>
            </span>
        </footer>
    </div>
    


            <div class="footerPrintView">
                <div class="footerCopyrightPrintView">© 2014 Microsoft</div>
            </div>

            
            
    
    
    <input id="tocPaddingPerLevel" type="hidden" value="17">



            <input id="MtpsDevice" type="hidden" value="Default">


<!--[CDATA[ Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft.  See ASP.NET Ajax CDN Terms of Use – http://www.asp.net/ajaxlibrary/CDN.ashx. ]]-->

            
            
            
            
            







<noscript>&lt;div&gt;&lt;img alt="DCSIMG" id="Img1" width="1" height="1" src="http://m.webtrends.com/dcsmgru7m99k7mqmgrhudo0k8_8c6m/njs.gif?dcsuri=/nojavascript&amp;amp;WT.js=No" /&gt;&lt;/div&gt;</noscript>









<noscript>
  &lt;a href="http://www.omniture.com" title="Web Analytics"&gt;
    &lt;img src="//msstonojsmsdn.112.2o7.net/b/ss/msstonojsmsdn/1/H.20.2--NS/0" height="1" width="1" border="0" alt="" /&gt;
  &lt;/a&gt;
</noscript>




<div id="globalRequestVerification">
    <input name="__RequestVerificationToken" type="hidden" value="r7YBlwlrCBKIDjE0JKU7CcMiJBf8X0cEpo6AFLNly82uNavxOjkYTpOaunRPXGBAhh-y7ot73fwnL44SJfJjwyKoYQqkBfuZYgWfHZCs3mbrblf10">
</div>


        </div>

        
        
        
        
    <script type="text/javascript" class="mtps-injected">
/*<![CDATA[*/
(function(window,document){"use strict";function preload(scripts){for(var result=[],script,e,i=0;i<scripts.length;i++)script=scripts[i],script.hasOwnProperty("url")&&(e=document.createElement("script"),e.src=script.url,script.throwaway=e),result.push(script);return result}function inject(scripts,index){var script,elem;if(index>=scripts.length){delete mtps.injectScripts;return}script=scripts[index];elem=document.createElement("script");elem.className="mtps-injected";elem.async=!1;var isLoaded=!1,timeoutId=0,injectNextFnName="",injectNext=elem.onerror=function(){isLoaded||(isLoaded=!0,inject(scripts,index+1),window.clearTimeout(timeoutId),elem.onload=elem.onerror=elem.onreadystatechange=null,injectNextFnName&&delete mtps[injectNextFnName],elem.removeEventListener&&elem.removeEventListener("load",injectNext,!1))};elem.addEventListener?elem.addEventListener("load",injectNext,!1):elem.readyState==="uninitialized"?elem.onreadystatechange=function(){(this.readyState==="loaded"||this.readyState==="complete")&&injectNext()}:elem.onload=injectNext;script.hasOwnProperty("url")?(timeoutId=window.setTimeout(injectNext,12e4),elem.src=script.url):(injectNextFnName="_injectNextScript_"+index,mtps[injectNextFnName]=injectNext,timeoutId=window.setTimeout(injectNext,2e3),elem.text="try {\n"+script.txt+"\n} finally { MTPS."+injectNextFnName+" && MTPS."+injectNextFnName+"(); }");parent.appendChild(elem)}var mtps=window.MTPS||(window.MTPS={}),parent=document.getElementsByTagName("head")[0];mtps.injectScripts=function(scripts){inject(preload(scripts),0)}})(window,document);
MTPS.injectScripts([
	{ txt: "/**/\r\n(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { \r\n\t\"image\": \"http://i.msdn.microsoft.com\", \r\n\t\"js\": \"http://i2.msdn.microsoft.com\", \r\n\t\"css\": \"http://i3.msdn.microsoft.com\", \r\n\t\"xap\": \"http://msdn.microsoft.com\"\r\n});\r\n/**/" },
	{ url: "http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.2.min.js" },
	{ txt: "//\n  var literalNormalizedUrl = \u0027/en-us/library/ms997538(l=en-us,v=msdn.10).aspx\u0027;\n  var wt_nvr_ru = \u0027WT_NVR_RU\u0027;\n  var wt_fpcdom = \u0027.microsoft.com\u0027;\n  var wt_domlist = \u0027msdn.microsoft.com\u0027;\n  var wt_pathlist = \u0027\u0027;\n  var wt_paramlist = \u0027DCSext.mtps_devcenter\u0027;\n  var wt_siteid = \u0027MSDN\u0027;\n  var gDomain = \u0027m.webtrends.com\u0027;\n  var gDcsId = \u0027dcsmgru7m99k7mqmgrhudo0k8_8c6m\u0027;\n  var gFpc = \u0027WT_FPC\u0027;\n\n\n\n  if (document.cookie.indexOf(gFpc + \"=\") == -1) {\n    var wtidJs = document.createElement(\"script\");\n    wtidJs.src = \"//\" + gDomain + \"/\" + gDcsId + \"/wtid.js\";\n    document.getElementsByTagName(\"head\")[0].appendChild(wtidJs);\n  }\n\n\n\n  var detectedLocale = \u0027en-us\u0027;\n  var wtsp = \u0027msdnlib_w32_com\u0027;\n  var gTrackEvents = \u00270\u0027;\n/**/" },
	{ txt: "/**/\n  var omni_guid = \"1d9f847b-4ffe-44c3-acc7-e07daa1c8110\";\n/**/" },
	{ txt: "//\n\n            window.appInsightsId = \u002760854590-027a-4ae4-98be-2741a40f355f\u0027;\n            //" },
	{ url: "http://i2.msdn.microsoft.com/Combined.js?resources=0:Utilities,1:Layout,2:Header,3:FeedbackCounterAsync,1:Rating,2:Footer,0:Topic,4:webtrendsscript,5:omni_rsid_MSDN,0:AppInsightsPerf,6:Toc,1:SearchBox;/Areas/Epx/Content/Scripts:0,/Areas/Epx/Themes/Base/Content:1,/Areas/Centers/Themes/StandardDevCenter/Content:2,/Areas/Epx/Shared/Content:3,/Areas/Global/Content/Webtrends/resources:4,/Areas/Global/Content/Omniture/resources/MSDN:5,/Areas/Library/Content:6\u0026amp;hashKey=7BE5AEF5C4D1D2A8D51DDFA40FFA44AF" },
	{ url: "http://i1.services.social.microsoft.com/search/Widgets/SearchBox.jss?boxid=HeaderSearchTextBox\u0026btnid=HeaderSearchButton\u0026brand=Msdn\u0026loc=en-us\u0026focusOnInit=false\u0026emptyWatermark=true\u0026searchButtonTooltip=Search MSDN" },
	{ url: "http://i2.msdn.microsoft.com/Combined.js?resources=0:PrintExportButton,1:NavigationResize,1:LibraryMemberFilter,2:Toc_Fixed,2:CodeSnippet,2:TopicNotInScope,2:CollapsibleArea,2:VersionSelector,2:SurveyBroker;/Areas/Library/Themes/Base/Content:0,/Areas/Library/Content:1,/Areas/Epx/Content/Scripts:2\u0026amp;hashKey=3248804C2DE1E642F8B20C4F83DBEA3B" },
	{ txt: "$(document).ready(function() {\n        try {\n            var token = $(\"#globalRequestVerification input[name=\u0027__RequestVerificationToken\u0027]\").clone();\n            $(\"#siteFeedbackForm\").append(token);\n        } catch(err) {\n            \n        }\n    });" }
]);

/*]]>*/
</script>
<script src="./Icons_files/broker-config.js"></script><div id="_WEDCSInsertedData" style="display: none;"><iframe id="_msnFrame" src="./Icons_files/c.gif" style="z-index:-1;height:1px;width:1px;display:none;visibility:hidden;" onload="javascript:MscomBeacon();"></iframe></div></body></html>